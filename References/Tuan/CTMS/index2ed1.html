<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

	
<!-- Mirrored from ctms.engin.umich.edu/CTMS/index.php?example=InvertedPendulum&section=ControlRootLocus by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:11:46 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>

		<script type="text/javascript" src="jquery.js"></script>
					
		<link rel='stylesheet' type='text/css' href='style.css' />
		<script type="text/javascript">
	
			var example = "InvertedPendulum"; 
			var section = "ControlRootLocus"; 
			var aux = ""; 
			var effects = Boolean(1); 
			var tips = Boolean(1); 
			$.fx.off = !effects;
			
			$(document).keydown(function(e){
				if (!$("#search_field").is(":focus")){
					if (e.keyCode == 39) { 
						window.location = "index64c4.html?example=InvertedPendulum&amp;section=ControlFrequency";
					}
					if (e.keyCode == 37) { 
						window.history.back()
					}
				}
			});		
			
		</script>
			
		<meta http-equiv="Content-Type" Content="text/html; charset=utf-8" />
		<meta http-equiv="PRAGMA" Content="NO-CACHE" />
		
		<title>Control Tutorials for MATLAB and Simulink - Inverted Pendulum: Root Locus Controller Design</title>
			
	</head>

	<body>
	
		
		<div id="container">
		
			<form id="search_form"><input id="search_field" type="text" name="q" placeholder="Search Control Tutorials"/></form>
			<form class="option_form" method="post" onclick="submit()"><div>Effects</div><input type="hidden" name="effects" value="0"/><input type="checkbox" name="effects" value="1" checked='true' /></form>
			<form class="option_form" method="post" onclick="submit()"><div>Tips</div><input type="hidden" name="tips" value="0"/><input type="checkbox" name="tips" value="1" checked='true' /></form>	
				
			<div style="clear:both"></div>
		
			<div id="header">
		
				

				
				
				<div id="menu_container">
				
					<ul class="menu">
						<li class="heading" id="Tips"><a href="index80e7.html?aux=Extras_Tips">TIPS</a></li>
						<div class="collapse"><div class="expand">
						</div></div>
					</ul>
				
					<ul class="menu">
						<li class="heading" id="About"><a>ABOUT</a></li>
						<div class="collapse"><div class="expand">
							<li class="item" id="About_Tutorials"><a href="index64fe.html?aux=About_Tutorials">Tutorials</a></li>
							<li class="item" id="About_Contact"><a href="mailto:ControlTutorialsMatlabSimulink@gmail.com">Contact</a></li>
						</div></div>
					</ul>
					
					<ul class="menu">
						<li class="heading" id="Basics"><a>BASICS</a></li>
						<div class="collapse"><div class="expand">
							<li class="item" id="Basics_Matlab"><a href="index87b6.html?aux=Basics_Matlab">MATLAB</a></li>
							<li class="item" id="Basics_Simulink"><a href="indexe9ea.html?aux=Basics_Simulink">Simulink</a></li>
						</div></div>
					</ul>
					
					<ul class="menu">
						<li class="heading" id="Index"><a>INDEX</a></li>
						<div class="collapse"><div class="expand">
							<li class="item" id="Index_Tutorials"><a href="index5e52.html?aux=Index_Tutorials">Tutorials</a></li>
							<li class="item" id="Index_Commands"><a href="index111e.html?aux=Index_Commands">Commands</a></li>
							<li class="item" id="Index_Animations"><a href="indexc3c5.html?aux=Index_Animations">Animations</a></li>
							<li class="item" id="Index_Extras"><a href="indexb290.html?aux=Index_Extras">Extras</a></li>
						</div></div>
					</ul>
									
					<ul class="menu">
						<li class="heading" id="Next"><a href="index64c4.html?example=InvertedPendulum&amp;section=ControlFrequency">NEXT&nbsp;&#x25BA;</a></li>
						<div class="collapse"><div class="expand">
						</div></div>
					</ul>
											
				</div>

			</div>
			
			<div id="body_container">
			
				<div id="gradient_container"></div>
			
				<div id="top">
				
					<a href="index1304.html?aux=Home"><img id="CTMS_logo" src="Images/CTMS_logo.png"></a>
				
					<ul class="example">
					
						<li class="item" id="Introduction"><a href="indexe528.html?example=Introduction&amp;section=ControlRootLocus"><img class="icon" src="Images/Introduction_Icon.png"><div class="tab">INTRODUCTION</div></a></li>
						<li class="item" id="CruiseControl"><a href="index4431.html?example=CruiseControl&amp;section=ControlRootLocus"><img class="icon" src="Images/CruiseControl_Icon.png"><div class="tab">CRUISE&nbsp;CONTROL</div></a></li>
						<li class="item" id="MotorSpeed"><a href="index9e58.html?example=MotorSpeed&amp;section=ControlRootLocus"><img class="icon" src="Images/MotorSpeed_Icon.png"><div class="tab">MOTOR&nbsp;SPEED</div></a></li>
						<li class="item" id="MotorPosition"><a href="index3c83.html?example=MotorPosition&amp;section=ControlRootLocus"><img class="icon" src="Images/MotorPosition_Icon.png"><div class="tab">MOTOR&nbsp;POSITION</div></a></li>
						<li class="item" id="Suspension"><a href="index8618.html?example=Suspension&amp;section=ControlRootLocus"><img class="icon" src="Images/Suspension_Icon.png"><div class="tab">SUSPENSION</div></a></li>
						<li class="item" id="InvertedPendulum"><a href="index2ed1.html?example=InvertedPendulum&amp;section=ControlRootLocus"><img class="icon" src="Images/InvertedPendulum_Icon.png"><div class="tab">INVERTED&nbsp;PENDULUM</div></a></li>
						<li class="item" id="AircraftPitch"><a href="index559a.html?example=AircraftPitch&amp;section=ControlRootLocus"><img class="icon" src="Images/AircraftPitch_Icon.png"><div class="tab">AIRCRAFT&nbsp;PITCH</div></a></li>
						<li class="item" id="BallBeam"><a href="indexc9b8.html?example=BallBeam&amp;section=ControlRootLocus"><img class="icon" src="Images/BallBeam_Icon.png"><div class="tab">BALL&nbsp;&amp;&nbsp;BEAM</div></a></li>
					
					</ul> 
		
				</div>
				
				<div id="content_container">
					<div class="content">
   <div class="content_fx">
      <h1>Inverted Pendulum: Root Locus Controller Design</h1>
      <!--introduction-->
      <p>Key MATLAB commands used in this tutorial are: <a href="http://www.mathworks.com/help/toolbox/control/ref/ss.html"><tt>tf</tt></a> , <a href="http://www.mathworks.com/help/toolbox/control/ref/rlocus.html"><tt>rlocus</tt></a> , <a href="http://www.mathworks.com/help/toolbox/control/ref/pole.html"><tt>pole</tt></a> , <a href="http://www.mathworks.com/help/toolbox/control/ref/zero.html"><tt>zero</tt></a> , <a href="http://www.mathworks.com/help/toolbox/control/ref/zpk.html"><tt>zpk</tt></a> , <a href="http://www.mathworks.com/help/toolbox/control/ref/feedback.html"><tt>feedback</tt></a> , <a href="http://www.mathworks.com/help/toolbox/control/ref/impulse.html"><tt>impulse</tt></a></p>
      <!--/introduction-->
      <h2>Contents</h2>
      <div>
         <ul>
            <li><a href="#3">System structure</a></li>
            <li><a href="#7">Root locus design</a></li>
            <li><a href="#11">PID control</a></li>
            <li><a href="#17">What happens to the cart's position?</a></li>
         </ul>
      </div>
      <p>In this page we will design a controller for the inverted pendulum system using the root locus design method. In the design
         process we will assume a single-input, single-output plant as described by the following transfer function. Otherwise stated,
         we will attempt to control the pendulum's angle without regard for the cart's position.
      </p>
      <p><span class="eqn_num">(1)</span><img class="display_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq04703.png" alt="$$P_{pend}(s) = \frac{\Phi(s)}{U(s)}=\frac{\frac{ml}{q}s}{s^3+\frac{b(I+ml^2)}{q}s^2-\frac{(M+m)mgl}{q}s-\frac{bmgl}{q}} \qquad [ \frac{rad}{N}]$$"></p>
      <p>where,</p>
      <p><span class="eqn_num">(2)</span><img class="display_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq24198.png" alt="$$q = (M+m)(I+ml^2) - (ml)^2$$"></p>
      <p>More specifically, the controller will attempt to maintain the pendulum vertically upward when the cart is subjected to a
         1-Nsec impulse. Under these conditions, the design criteria are:
      </p>
      <div>
         <ul>
            <li>Settling time of less than 5 seconds</li>
            <li>Pendulum should not move more than 0.05 radians away from the vertical</li>
         </ul>
      </div>
      <p>For the original problem setup and the derivation of the above transfer function, please consult the <a href="indexdeb1.html?example=InvertedPendulum&amp;section=SystemModeling">Inverted Pendulum: System Modeling</a> page.
      </p>
      <h2>System structure<a name="3"></a></h2>
      <p>The structure of the controller for this problem is a little different than the standard control problems you may be used
         to. Since we are attempting to control the pendulum's position, which should return to the vertical after the initial disturbance,
         the reference signal we are tracking should be zero. This type of situation is often referred to as a regulator problem. The
         external force applied to the cart can be considered as an impulsive disturbance. The schematic for this problem is depicted
         below.
      </p>
      <p><img class="figure"vspace="5" hspace="5" src="Content/InvertedPendulum/Control/RootLocus/figures/feedback_pend.png" alt=""> </p>
      <p>You may find it easier to analyze and design for this system if we first rearrange the schematic as follows.</p>
      <p><img class="figure"vspace="5" hspace="5" src="Content/InvertedPendulum/Control/RootLocus/figures/feedback_pend2.png" alt=""> </p>
      <p>The resulting transfer function <img class="inline_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq42924.png" alt="$T(s)$"> for the closed-loop system from an input of force <img class="inline_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq86924.png" alt="$F$"> to an output of pendulum angle <img class="inline_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq26509.png" alt="$\phi$"> is then determined to be the following.
      </p>
      <p><span class="eqn_num">(3)</span><img class="display_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq30884.png" alt="$$ T(s) = \frac{\Phi(s)}{F(s)} = \frac{P_{pend}(s)}{1 + C(s)} $$"></p>
      <p>Before we begin designing our controller, we first need to define our plant within MATLAB. Create a new <a href="indexd754.html?aux=Extras_Mfile">m-file</a> and type in the following commands to create the plant model (refer to the main problem for the details of getting these
         commands).
      </p><pre class="codeinput">M = 0.5;
m = 0.2;
b = 0.1;
I = 0.006;
g = 9.8;
l = 0.3;
q = (M+m)*(I+m*l^2)-(m*l)^2;
s = tf(<span class="string">'s'</span>);
P_pend = (m*l*s/q)/(s^3 + (b*(I + m*l^2))*s^2/q - ((M + m)*m*g*l)*s/q - b*m*g*l/q);
</pre><h2>Root locus design<a name="7"></a></h2>
      <p>We will now begin to design a controller for our system employing a root locus design method. We can use the MATLAB command
         <tt>rlocus</tt> for generating the root locus plots. Adding the following commands to your m-file and running it in the MATLAB command window
         will create the root locus plot shown below. This plot displays all possible closed-loop pole locations as a simple proportional
         control gain <img class="inline_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq14888.png" alt="$K$"> is varied from 0 to infinity. The root locus is the same whether the multiplicative gain <img class="inline_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq14888.png" alt="$K$"> is in the forward or feedback path of the closed-loop system.
      </p><pre class="codeinput">rlocus(P_pend)
title(<span class="string">'Root Locus of Plant (under Proportional Control)'</span>)
</pre><img class="figure"vspace="5" hspace="5" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_01.png" alt=""> <p>As you can see, one of the branches of the root locus is entirely in the right-half of the complex <img class="inline_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq72999.png" alt="$s$">-plane. This means that no matter the choice of gain <img class="inline_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq14888.png" alt="$K$">, there will always be a closed-loop pole in the right-half plane making the system's impulse response unstable.
      </p>
      <p>To solve this problem, we need to add a pole at the origin (an integrator) via the controller to cancel the plant zero at
         the origin. This addition will produce two closed-loop poles in the right-half plane. In our subsequent design we can then
         modify our controller to draw these poles into the left-half plane, thereby stabilizing the closed-loop system. Modifying
         your m-file with the following commands and re-running in the MATLAB command window will produce the root locus plot shown
         below.
      </p><pre class="codeinput">C = 1/s;
rlocus(C*P_pend)
title(<span class="string">'Root Locus with Integral Control'</span>)
</pre><img class="figure"vspace="5" hspace="5" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_02.png" alt=""> <p>Let's also examine the locations of the system's open-loop poles and zeros so that we may begin to think about how to draw
         the root locus branches into the left-half plane. Entering the following commands into the MATLAB command window will generate
         the following output.
      </p><pre class="codeinput">zeros = zero(C*P_pend)
poles = pole(C*P_pend)
</pre><pre class="codeoutput">zeros =
     0
poles =
         0
    5.5651
   -5.6041
   -0.1428
</pre><p>As you can see, there are four poles and only one zero. This means that the root locus will have three asymptotes: one along
         the real axis in the negative direction, and the other two at 120 degree angles to this one.
      </p>
      <p>This configuration is also unsatisfactory because we still have branches of the root locus that are entirely in the right-half
         complex plane. In general, we can pull the branches of our root locus to the left in the complex plane by adding zeros to
         our system. Adding a zero to our controller will reduce the number of asymptotes from three to two.  These two asymptotes
         will be parallel to the imaginary axis and will intersect the real axis at the location <img class="inline_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq72999.png" alt="$s$"> calculated from the following expression.
      </p>
      <p><span class="eqn_num">(4)</span><img class="display_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq76554.png" alt="$$ s = \frac{\Sigma poles - \Sigma zeros}{\#poles - \#zeros} $$"></p>
      <p>Therefore, for our system as described so far, we have the following assuming a minimum-phase zero (negative).</p>
      <p><span class="eqn_num">(5)</span><img class="display_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq62044.png" alt="$$ s = \frac{(-5.6041+5.5651-0.1428+0)-(0-z)}{4-2} = \frac{-0.1818+z}{2} $$"></p>
      <p>Based on the above, the farthest we can pull the asymptotes to the left in the complex plane is approximately -0.1 for a negligibly
         small zero. Recall that 2% settling time can be estimated from the following equation.
      </p>
      <p><span class="eqn_num">(6)</span><img class="display_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq16443.png" alt="$$ T_s = \frac{4}{\sigma} $$"></p>
      <p>Therefore, dominant closed-loop poles with real parts that approach -0.1 will not be sufficient to meet the 5 second settling
         time that we require.
      </p>
      <h2>PID control<a name="11"></a></h2>
      <p>In the above discussion we demonstrated that adding a zero to our integral controller could pull the branches of the root
         locus to the left in the complex plane, but we were not able to the pull the dominant branches far enough to the left. A possible
         solution is to add yet another zero. If we place both zeros on the negative real axis between the two plant poles, then the
         two branches in the right-half plane will be pulled into the left-half plane and will terminate at these two zeros. Let's
         specifically evaluate the root locus for a controller with an integrator and zeros at -3 and -4. Note that this controller
         is actually a PID controller. We can create this controller within MATLAB using the <tt>zpk</tt> command which creates a model by specifying the zeros, poles, and gain of the system. Modifying your m-file with the following
         commands and re-running will produce the root locus plot shown below.
      </p><pre class="codeinput">z = [-3 -4];
p = 0;
k = 1;
C = zpk(z,p,k);
rlocus(C*P_pend)
title(<span class="string">'Root Locus with PID Controller'</span>)
</pre><img class="figure"vspace="5" hspace="5" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_03.png" alt=""> <p>Examining the above root locus helps us to determine whether or not our given requirements can be met. Specifically, since
         it is desired that the settling time of the system be less than 5 seconds, the real parts of our dominant closed-loop poles
         should be less than approximately -4/5 = -0.8. In other words, our dominatnt closed-loop poles should be located in the complex
         <img class="inline_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq72999.png" alt="$s$">-plane to the left of a vertical line at <img class="inline_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq51241.png" alt="$s = -0.8$">. Inspection of the above shows that this is possible. Since it is also desired that the pendulum not move more than 0.05
         radians away from vertical, we also want to ensure that the closed-loop system has sufficient damping. Placing the dominant
         closed-loop poles near the real axis will increase the system's damping (small <img class="inline_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq42727.png" alt="$\beta$">).
      </p>
      <p>To find the gain corresponding to a specific point on the root locus, we can use the <tt>rlocfind</tt> command. Specifically, enter the command <tt>[k,poles] = rlocfind(C*P_pend)</tt> in the MATLAB command window.
      </p>
      <p>Then go to the plot and select a point on the root locus on left side of the loop, close to the real axis as shown below with
         the small <tt>+</tt> marks. Selecting these poles will ensure that the system settles sufficiently fast and, hopefully, that it has sufficient
         damping.
      </p>
      <p><img class="figure"vspace="5" hspace="5" src="Content/InvertedPendulum/Control/RootLocus/figures/Figure1.png" alt=""> </p>
      <p>After doing this, you should see an output like the following in the MATLAB command window.</p>
      <p>
         </p><pre class="codeoutput">Select a point in the graphics window
         </p>
         selected_point =
         </p>
         -3.5367 + 0.7081i
         </p>
         </p>
         k =
         </p>
         20.2396
         </p>
         </p>
         poles =
         </p>
         0
         -85.1333
         -3.5232 + 0.7086i
         -3.5232 - 0.7086i
         </pre>
         
      </p>
      <p>Note that the values returned in your MATLAB command window may not be exactly the same, but they should at least have the
         same order of magnitude.
      </p>
      <p>Then we can check the impulse response of our closed-loop system to see if our requirements are actually met for a gain <img class="inline_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq14888.png" alt="$K$"> of approximately 20. Add the following commands to your m-file and re-run to generate a closed-loop impulse response like
         the one shown below.
      </p><pre class="codeinput">K = 20;
T = feedback(P_pend,K*C);
impulse(T)
title(<span class="string">'Response of Pendulum Angle to an Impulse Disturbance under PID Control'</span>);
</pre><img class="figure"vspace="5" hspace="5" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_04.png" alt=""> <p>Examination of the above demonstrates that all of the given requirements are met.</p>
      <h2>What happens to the cart's position?<a name="17"></a></h2>
      <p>At the beginning of this page, a block diagram for the inverted pendulum system was given. The diagram was not entirely complete.
         The block representing the response of the cart's position <img class="inline_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq43551.png" alt="$x$"> was not included because that variable is not being controlled. It is interesting though, to see what is happening to the
         cart's position when the controller for the pendulum's angle is in place. To see this we need to consider the full system
         block diagram as shown in the following figure.
      </p>
      <p><img class="figure"vspace="5" hspace="5" src="Content/InvertedPendulum/Control/RootLocus/figures/feedback_pend3.png" alt=""> </p>
      <p>Rearranging, we get the following block diagram.</p>
      <p><img class="figure"vspace="5" hspace="5" src="Content/InvertedPendulum/Control/RootLocus/figures/feedback_pend4.png" alt=""> </p>
      <p>In the above, the block <img class="inline_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq46098.png" alt="$C(s)$"> is the controller designed for maintaining the pendulum vertical. The closed-loop transfer function <img class="inline_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq08994.png" alt="$T_2(s)$"> from an input force applied to the cart to an output of cart position is, therefore, given by the following.
      </p>
      <p><span class="eqn_num">(7)</span><img class="display_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq20946.png" alt="$$ T_2(s) = \frac{X(s)}{F(s)} = \frac{P_{cart}(s)}{1 + P_{pend}(s)C(s)}$$"></p>
      <p>Referring to the <a href="indexdeb1.html?example=InvertedPendulum&amp;section=SystemModeling">Inverted Pendulum: System Modeling</a> page, the transfer function for <img class="inline_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq12765.png" alt="$\mathrm{P_{cart}}(s)$"> is defined as follows.
      </p>
      <p><span class="eqn_num">(8)</span><img class="display_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq29227.png" alt="$$P_{cart}(s) = \frac{X(s)}{U(s)} = \frac{ \frac{ (I+ml^2)s^2 - gml } {q}&#xA;}{s^4+\frac{b(I+ml^2)}{q}s^3-\frac{(M+m)mgl}{q}s^2-\frac{bmgl}{q}s}&#xA;\qquad [ \frac{m}{N}] $$"></p>
      <p>where,</p>
      <p><span class="eqn_num">(9)</span><img class="display_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq00187.png" alt="$$q=[(M+m)(I+ml^2)-(ml)^2]$$"></p>
      <p>Adding the following commands to your m-file (presuming <img class="inline_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq75257.png" alt="$\mathrm{P_{pend}}(s)$"> and <img class="inline_eqn" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_eq46098.png" alt="$C(s)$"> are still defined) will generate the response of the cart's position to the same impulsive disturbance we have been considering.
      </p><pre class="codeinput">P_cart = (((I+m*l^2)/q)*s^2 - (m*g*l/q))/(s^4 + (b*(I + m*l^2))*s^3/q - ((M + m)*m*g*l)*s^2/q - b*m*g*l*s/q);
T2 = feedback(1,P_pend*C)*P_cart;
t = 0:0.01:8.5;
impulse(T2, t);
title(<span class="string">'Response of Cart Position to an Impulse Disturbance under PID Control'</span>);
</pre><img class="figure"vspace="5" hspace="5" src="Content/InvertedPendulum/Control/RootLocus/html/InvertedPendulum_ControlRootLocus_05.png" alt=""> <p>As you can see, the cart's position goes unstable for this impulse disturbance. Therefore, although the PID controller stabilizes
         the angle of the pendulum, this design would not be feasible to implement on an actual physical system.
      </p>
      <p class="footer"><br>
         Published with MATLAB&reg; 7.14<br></p>
   </div>
</div>
<!--
##### SOURCE BEGIN #####
%% Inverted Pendulum: Root Locus Controller Design
%
% Key MATLAB commands used in this tutorial are:
% <http://www.mathworks.com/help/toolbox/control/ref/ss.html |tf|> , 
% <http://www.mathworks.com/help/toolbox/control/ref/rlocus.html |rlocus|> , 
% <http://www.mathworks.com/help/toolbox/control/ref/pole.html |pole|> ,
% <http://www.mathworks.com/help/toolbox/control/ref/zero.html |zero|> ,
% <http://www.mathworks.com/help/toolbox/control/ref/zpk.html |zpk|> ,
% <http://www.mathworks.com/help/toolbox/control/ref/feedback.html |feedback|> ,  
% <http://www.mathworks.com/help/toolbox/control/ref/impulse.html |impulse|>
%
%%
% In this page we will design a controller for the inverted pendulum
% system using the root locus design method. In the design process we will
% assume a single-input, single-output plant as described by the following
% transfer function. Otherwise stated, we will attempt to control the
% pendulum's angle without regard for the cart's position.
% 
% $$P_{pend}(s) = \frac{\Phi(s)}{U(s)}=\frac{\frac{ml}{q}s}{s^3+\frac{b(I+ml^2)}{q}s^2-\frac{(M+m)mgl}{q}s-\frac{bmgl}{q}} \qquad [ \frac{rad}{N}]$$
% 
% where,
% 
% $$q = (M+m)(I+ml^2) - (ml)^2$$
% 
% More specifically, the controller will attempt to maintain the pendulum
% vertically upward when the cart is subjected to a 1-Nsec impulse. Under
% these conditions, the design criteria are:
%
% * Settling time of less than 5 seconds
% * Pendulum should not move more than 0.05 radians away from the vertical
%
%%
% For the original problem setup and the derivation of the above transfer function,
% please consult the < ?example=InvertedPendulum&section=SystemModeling 
% Inverted Pendulum: System Modeling> page. 
% 
%% System structure
%
% The structure of the controller for this problem is a little different
% than the standard control problems you may be used to. Since we are
% attempting to control the pendulum's position, which should return to the
% vertical after the initial disturbance, the reference signal we are
% tracking should be zero. This type of situation is often referred to as a
% regulator problem. The external force applied to the cart can be considered as an
% impulsive disturbance. The schematic for this problem is depicted below.
%
% <<Content/InvertedPendulum/Control/RootLocus/figures/feedback_pend.png>>
%
%%
% You may find it easier to analyze and design for this system if we first
% rearrange the schematic as follows.
%
% <<Content/InvertedPendulum/Control/RootLocus/figures/feedback_pend2.png>>
%
%%
% The resulting transfer function $T(s)$ for the closed-loop system from an input of force
% $F$ to an output of pendulum angle $\phi$ is then determined to be the following.
%
% $$ T(s) = \frac{\Phi(s)}{F(s)} = \frac{P_{pend}(s)}{1 + C(s)} $$
%
%%
% Before we begin designing our controller, we first need to define our
% plant within MATLAB. Create a new
% < ?aux=Extras_Mfile m-file> and type in
% the following commands to create the plant model (refer to the main
% problem for the details of getting these commands). 

M = 0.5;
m = 0.2;
b = 0.1;
I = 0.006;
g = 9.8;
l = 0.3;
q = (M+m)*(I+m*l^2)-(m*l)^2;
s = tf('s');
P_pend = (m*l*s/q)/(s^3 + (b*(I + m*l^2))*s^2/q - ((M + m)*m*g*l)*s/q - b*m*g*l/q);

%% Root locus design
% 
% We will now begin to design a controller for our system employing a root
% locus design method. We can use the MATLAB command |rlocus| for
% generating the root locus plots. Adding the following commands to your m-file
% and running it in the MATLAB command window will create the root locus
% plot shown below. This plot displays all possible closed-loop
% pole locations as a simple proportional control gain $K$ is varied from 0 to
% infinity. The root locus is the same whether the multiplicative gain $K$ is
% in the forward or feedback path of the closed-loop system.

rlocus(P_pend)
title('Root Locus of Plant (under Proportional Control)')

%%
% As you can see, one of the branches of the root locus is entirely in the
% right-half of the complex $s$-plane. This means that no matter the choice
% of gain $K$, there will always be a closed-loop pole in the right-half
% plane making the system's impulse response unstable.
%
% To solve this problem, we need to add a pole at the origin (an
% integrator) via the controller to cancel the plant zero at the origin.
% This addition will produce two closed-loop poles in the right-half plane.
% In our subsequent design we can then modify our controller to draw these
% poles into the left-half plane, thereby stabilizing the closed-loop
% system. Modifying your m-file with the following commands and re-running
% in the MATLAB command window will produce the root locus plot shown
% below.

C = 1/s;
rlocus(C*P_pend)
title('Root Locus with Integral Control')

%%
% Let's also examine the locations of the system's open-loop poles and
% zeros so that we may begin to think about how to draw the root locus
% branches into the left-half plane. Entering the following commands into
% the MATLAB command window will generate the following output.

zeros = zero(C*P_pend)
poles = pole(C*P_pend)

%%
% As you can see, there are four poles and only one zero. This means that
% the root locus will have three asymptotes: one along the real axis in the negative
% direction, and the other two at 120 degree angles to this one. 
%
% This configuration is also unsatisfactory because we still have branches
% of the root locus that are entirely in the right-half complex plane. In general,
% we can pull the branches of our root locus to the left in the complex
% plane by adding zeros to our system. Adding a zero to our controller
% will reduce the number of asymptotes from three to two.  These two asymptotes
% will be parallel to the imaginary axis and will intersect the real axis
% at the location $s$ calculated from the following expression.
%
% $$ s = \frac{\Sigma poles - \Sigma zeros}{\#poles - \#zeros} $$
%
% Therefore, for our system as described so far, we have the following
% assuming a minimum-phase zero (negative).
%
% $$ s = \frac{(-5.6041+5.5651-0.1428+0)-(0-z)}{4-2} = \frac{-0.1818+z}{2} $$
%
% Based on the above, the farthest we can pull the asymptotes to the left
% in the complex plane is approximately -0.1 for a negligibly small zero.
% Recall that 2% settling time can be estimated from the following
% equation.  
%
% $$ T_s = \frac{4}{\sigma} $$
%
% Therefore, dominant closed-loop poles with real parts that approach -0.1 will not be
% sufficient to meet the 5 second settling time that we require.
%
%% PID control
% In the above discussion we demonstrated that adding a zero to our
% integral controller could pull the branches of the root locus to the left
% in the complex plane, but we were not able to the pull the dominant
% branches far enough to the left. A possible solution is to add yet
% another zero. If we place both zeros on the negative real axis between
% the two plant poles, then the two branches in the right-half plane will
% be pulled into the left-half plane and will terminate at these two zeros.
% Let's specifically evaluate the root locus for a controller with an
% integrator and zeros at -3 and -4. Note that this controller is actually a
% PID controller. We can create this controller within MATLAB using the
% |zpk| command which creates a model by specifying the zeros, poles, and
% gain of the system. Modifying your m-file with the following commands
% and re-running will produce the root locus plot shown below.

z = [-3 -4];
p = 0;
k = 1;
C = zpk(z,p,k);
rlocus(C*P_pend)
title('Root Locus with PID Controller')

%%
% Examining the above root locus helps us to determine whether or not our
% given requirements can be met. Specifically, since it is desired that the
% settling time of the system be less than 5 seconds, the real parts of our
% dominant closed-loop poles should be less than approximately -4/5 = -0.8.
% In other words, our dominatnt closed-loop poles should be located in the
% complex $s$-plane to the left of a vertical line at $s = -0.8$.
% Inspection of the above shows that this is possible. Since it is also
% desired that the pendulum not move more than 0.05 radians away from
% vertical, we also want to ensure that the closed-loop system has
% sufficient damping. Placing the dominant closed-loop poles near the real
% axis will increase the system's damping (small $\beta$).
%
% To find the gain corresponding to a specific point on the root locus, we
% can use the |rlocfind| command. Specifically, enter the command 
% |[k,poles] = rlocfind(C*P_pend)| in the MATLAB command window.
%
% Then go to the plot and select a point on the root locus on left side of
% the loop, close to the real axis as shown below with the small |+| marks. 
% Selecting these poles will ensure that the system settles sufficiently
% fast and, hopefully, that it has sufficient damping. 
%
% <<Content/InvertedPendulum/Control/RootLocus/figures/Figure1.png>>
%
%%
% After doing this, you should see an output like the following in the MATLAB
% command window. 
%%
% <html>
% </p><pre class="codeoutput">Select a point in the graphics window
% </p>
% selected_point =
% </p>
%   -3.5367 + 0.7081i
% </p>
% </p>
% k =
% </p>
%    20.2396
% </p>
% </p>
% poles =
% </p>
%        0          
% -85.1333          
%  -3.5232 + 0.7086i
%  -3.5232 - 0.7086i
% </pre>
% </html>
%%
% Note that the values returned in your MATLAB command window may not be
% exactly the same, but they should at least have the same order of magnitude.
%
% Then we can check the impulse response of our closed-loop system to see
% if our requirements are actually met for a gain $K$ of approximately 20.
% Add the following commands to your m-file and re-run to generate a
% closed-loop impulse response like the one shown below.

K = 20;
T = feedback(P_pend,K*C);
impulse(T)
title('Response of Pendulum Angle to an Impulse Disturbance under PID Control');

%%
% Examination of the above demonstrates that all of the given requirements
% are met. 
%
%% What happens to the cart's position?
% At the beginning of this page, a block diagram for the inverted pendulum
% system was given. The diagram was not entirely complete. The block 
% representing the response of the cart's position $x$ was not included
% because that variable is not being controlled. It is interesting though,
% to see what is happening to the cart's position when the controller for
% the pendulum's angle is in place. To see this we need to consider
% the full system block diagram as shown in the following figure.
% 
% <<Content/InvertedPendulum/Control/RootLocus/figures/feedback_pend3.png>>
% 
% Rearranging, we get the following block diagram.
% 
% <<Content/InvertedPendulum/Control/RootLocus/figures/feedback_pend4.png>>
% 
% In the above, the block $C(s)$ is the controller designed for maintaining
% the pendulum vertical. The closed-loop transfer function $T_2(s)$ from an input force applied
% to the cart to an output of cart position is, therefore, given by the
% following. 
%
% $$ T_2(s) = \frac{X(s)}{F(s)} = \frac{P_{cart}(s)}{1 + P_{pend}(s)C(s)}$$
%
%%
% Referring to the < ?example=InvertedPendulum&section=SystemModeling 
% Inverted Pendulum: System Modeling> page, the transfer function for
% $\mathrm{P_{cart}}(s)$ is defined as follows. 
% 
% $$P_{cart}(s) = \frac{X(s)}{U(s)} = \frac{ \frac{ (I+ml^2)s^2 - gml } {q}
% }{s^4+\frac{b(I+ml^2)}{q}s^3-\frac{(M+m)mgl}{q}s^2-\frac{bmgl}{q}s}
% \qquad [ \frac{m}{N}] $$
%
% where,
%
% $$q=[(M+m)(I+ml^2)-(ml)^2]$$
%
%%
% Adding the following commands to your m-file (presuming $\mathrm{P_{pend}}(s)$ and
% $C(s)$ are still defined) will generate the response of the cart's
% position to the same impulsive disturbance we have been considering.

P_cart = (((I+m*l^2)/q)*s^2 - (m*g*l/q))/(s^4 + (b*(I + m*l^2))*s^3/q - ((M + m)*m*g*l)*s^2/q - b*m*g*l*s/q);
T2 = feedback(1,P_pend*C)*P_cart;
t = 0:0.01:8.5;
impulse(T2, t);
title('Response of Cart Position to an Impulse Disturbance under PID Control');

%%
% As you can see, the cart's position goes unstable for this impulse
% disturbance. Therefore, although the PID controller stabilizes the angle
% of the pendulum, this design would not be feasible to implement on an
% actual physical system.
%

##### SOURCE END #####
-->				</div>
				
				<div id="left">

					<ul class="section">
						<li class="heading" id="System">SYSTEM<img class="section_heading_arrow" src="Images/section_heading_arrow.png"/></li>
						<li class="item" id="SystemModeling"><a href="indexdeb1.html?example=InvertedPendulum&amp;section=SystemModeling">MODELING<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
						<li class="item" id="SystemAnalysis"><a href="indexce00.html?example=InvertedPendulum&amp;section=SystemAnalysis">ANALYSIS<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
					</ul>
					
					<div class="section_break"></div>

					<ul class="section">
						<li class="heading" id="Control">CONTROL<img class="section_heading_arrow" src="Images/section_heading_arrow.png"/></li>
						<li class="item" id="ControlPID"><a href="index9b2d.html?example=InvertedPendulum&amp;section=ControlPID">PID<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
						<li class="item" id="ControlRootLocus"><a href="index2ed1.html?example=InvertedPendulum&amp;section=ControlRootLocus">ROOT&nbsp;LOCUS<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
						<li class="item" id="ControlFrequency"><a href="index64c4.html?example=InvertedPendulum&amp;section=ControlFrequency">FREQUENCY<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
						<li class="item" id="ControlStateSpace"><a href="index96a8.html?example=InvertedPendulum&amp;section=ControlStateSpace">STATE-SPACE<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
						<li class="item" id="ControlDigital"><a href="index5759.html?example=InvertedPendulum&amp;section=ControlDigital">DIGITAL<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
					</ul>
					
					<div class="section_break"></div>

					<ul class="section">
						<li class="heading" id="Simulink">SIMULINK<img class="section_heading_arrow" src="Images/section_heading_arrow.png"/></li>
						<li class="item" id="SimulinkModeling"><a href="indexffaa.html?example=InvertedPendulum&amp;section=SimulinkModeling">MODELING<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
						<li class="item" id="SimulinkControl"><a href="indexd477.html?example=InvertedPendulum&amp;section=SimulinkControl">CONTROL<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
					</ul>
		
				</div>
			
				<div style="clear:both"></div>
				
				<div id="bottombar"><span style="color:#FF5500;font-weight:bold">.</div>
				
			</div>
			
		</div>
	
		<script type="text/javascript" src="script.js"></script>
						
	</body>
	

<!-- Mirrored from ctms.engin.umich.edu/CTMS/index.php?example=InvertedPendulum&section=ControlRootLocus by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:11:53 GMT -->
</html>

	lRootLocus by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:11:53 GMT -->
</html>

	<script type="text/javascript" src="script.js"></script>
						
	</body>
	

<!-- Mirrored from ctms.engin.umich.edu/CTMS/index.php?example=InvertedPendulum&section=ControlRootLocus by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:11:53 GMT -->
</html>

	lRootLocus by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:11:53 GMT -->
</html>

	pier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:11:53 GMT -->
</html>

	lRootLocus by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:11:53 GMT -->
</html>

	