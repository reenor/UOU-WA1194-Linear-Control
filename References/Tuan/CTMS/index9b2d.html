<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

	
<!-- Mirrored from ctms.engin.umich.edu/CTMS/index.php?example=InvertedPendulum&section=ControlPID by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:11:40 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>

		<script type="text/javascript" src="jquery.js"></script>
					
		<link rel='stylesheet' type='text/css' href='style.css' />
		<script type="text/javascript">
	
			var example = "InvertedPendulum"; 
			var section = "ControlPID"; 
			var aux = ""; 
			var effects = Boolean(1); 
			var tips = Boolean(1); 
			$.fx.off = !effects;
			
			$(document).keydown(function(e){
				if (!$("#search_field").is(":focus")){
					if (e.keyCode == 39) { 
						window.location = "index2ed1.html?example=InvertedPendulum&amp;section=ControlRootLocus";
					}
					if (e.keyCode == 37) { 
						window.history.back()
					}
				}
			});		
			
		</script>
			
		<meta http-equiv="Content-Type" Content="text/html; charset=utf-8" />
		<meta http-equiv="PRAGMA" Content="NO-CACHE" />
		
		<title>Control Tutorials for MATLAB and Simulink - Inverted Pendulum: PID Controller Design</title>
			
	</head>

	<body>
	
		
		<div id="container">
		
			<form id="search_form"><input id="search_field" type="text" name="q" placeholder="Search Control Tutorials"/></form>
			<form class="option_form" method="post" onclick="submit()"><div>Effects</div><input type="hidden" name="effects" value="0"/><input type="checkbox" name="effects" value="1" checked='true' /></form>
			<form class="option_form" method="post" onclick="submit()"><div>Tips</div><input type="hidden" name="tips" value="0"/><input type="checkbox" name="tips" value="1" checked='true' /></form>	
				
			<div style="clear:both"></div>
		
			<div id="header">
		
				

				
				
				<div id="menu_container">
				
					<ul class="menu">
						<li class="heading" id="Tips"><a href="index80e7.html?aux=Extras_Tips">TIPS</a></li>
						<div class="collapse"><div class="expand">
						</div></div>
					</ul>
				
					<ul class="menu">
						<li class="heading" id="About"><a>ABOUT</a></li>
						<div class="collapse"><div class="expand">
							<li class="item" id="About_Tutorials"><a href="index64fe.html?aux=About_Tutorials">Tutorials</a></li>
							<li class="item" id="About_Contact"><a href="mailto:ControlTutorialsMatlabSimulink@gmail.com">Contact</a></li>
						</div></div>
					</ul>
					
					<ul class="menu">
						<li class="heading" id="Basics"><a>BASICS</a></li>
						<div class="collapse"><div class="expand">
							<li class="item" id="Basics_Matlab"><a href="index87b6.html?aux=Basics_Matlab">MATLAB</a></li>
							<li class="item" id="Basics_Simulink"><a href="indexe9ea.html?aux=Basics_Simulink">Simulink</a></li>
						</div></div>
					</ul>
					
					<ul class="menu">
						<li class="heading" id="Index"><a>INDEX</a></li>
						<div class="collapse"><div class="expand">
							<li class="item" id="Index_Tutorials"><a href="index5e52.html?aux=Index_Tutorials">Tutorials</a></li>
							<li class="item" id="Index_Commands"><a href="index111e.html?aux=Index_Commands">Commands</a></li>
							<li class="item" id="Index_Animations"><a href="indexc3c5.html?aux=Index_Animations">Animations</a></li>
							<li class="item" id="Index_Extras"><a href="indexb290.html?aux=Index_Extras">Extras</a></li>
						</div></div>
					</ul>
									
					<ul class="menu">
						<li class="heading" id="Next"><a href="index2ed1.html?example=InvertedPendulum&amp;section=ControlRootLocus">NEXT&nbsp;&#x25BA;</a></li>
						<div class="collapse"><div class="expand">
						</div></div>
					</ul>
											
				</div>

			</div>
			
			<div id="body_container">
			
				<div id="gradient_container"></div>
			
				<div id="top">
				
					<a href="index1304.html?aux=Home"><img id="CTMS_logo" src="Images/CTMS_logo.png"></a>
				
					<ul class="example">
					
						<li class="item" id="Introduction"><a href="index6e33.html?example=Introduction&amp;section=ControlPID"><img class="icon" src="Images/Introduction_Icon.png"><div class="tab">INTRODUCTION</div></a></li>
						<li class="item" id="CruiseControl"><a href="index08fb.html?example=CruiseControl&amp;section=ControlPID"><img class="icon" src="Images/CruiseControl_Icon.png"><div class="tab">CRUISE&nbsp;CONTROL</div></a></li>
						<li class="item" id="MotorSpeed"><a href="index84c7.html?example=MotorSpeed&amp;section=ControlPID"><img class="icon" src="Images/MotorSpeed_Icon.png"><div class="tab">MOTOR&nbsp;SPEED</div></a></li>
						<li class="item" id="MotorPosition"><a href="indexe534.html?example=MotorPosition&amp;section=ControlPID"><img class="icon" src="Images/MotorPosition_Icon.png"><div class="tab">MOTOR&nbsp;POSITION</div></a></li>
						<li class="item" id="Suspension"><a href="index24ea.html?example=Suspension&amp;section=ControlPID"><img class="icon" src="Images/Suspension_Icon.png"><div class="tab">SUSPENSION</div></a></li>
						<li class="item" id="InvertedPendulum"><a href="index9b2d.html?example=InvertedPendulum&amp;section=ControlPID"><img class="icon" src="Images/InvertedPendulum_Icon.png"><div class="tab">INVERTED&nbsp;PENDULUM</div></a></li>
						<li class="item" id="AircraftPitch"><a href="indexb04e.html?example=AircraftPitch&amp;section=ControlPID"><img class="icon" src="Images/AircraftPitch_Icon.png"><div class="tab">AIRCRAFT&nbsp;PITCH</div></a></li>
						<li class="item" id="BallBeam"><a href="index543f.html?example=BallBeam&amp;section=ControlPID"><img class="icon" src="Images/BallBeam_Icon.png"><div class="tab">BALL&nbsp;&amp;&nbsp;BEAM</div></a></li>
					
					</ul> 
		
				</div>
				
				<div id="content_container">
					<div class="content">
   <div class="content_fx">
      <h1>Inverted Pendulum: PID Controller Design</h1>
      <!--introduction-->
      <p>Key MATLAB commands used in this tutorial are: <a href="http://www.mathworks.com/help/toolbox/control/ref/ss.html"><tt>tf</tt></a> , <a href="http://www.mathworks.com/help/toolbox/control/ref/tf.html"><tt>impulse</tt></a> , <a href="http://www.mathworks.com/help/toolbox/control/ref/feedback.html"><tt>feedback</tt></a> , <a href="http://www.mathworks.com/help/toolbox/control/ref/pid.html"><tt>pid</tt></a></p>
      <!--/introduction-->
      <h2>Contents</h2>
      <div>
         <ul>
            <li><a href="#3">System structure</a></li>
            <li><a href="#8">PID control</a></li>
            <li><a href="#14">What happens to the cart's position?</a></li>
         </ul>
      </div>
      <p>In this page we will design a PID controller for the inverted pendulum system. In the design process we will assume a single-input,
         single-output plant as described by the following transfer function. Otherwise stated, we will attempt to control the pendulum's
         angle without regard for the cart's position.
      </p>
      <p><span class="eqn_num">(1)</span><img class="display_eqn" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_eq04703.png" alt="$$P_{pend}(s) = \frac{\Phi(s)}{U(s)}=\frac{\frac{ml}{q}s}{s^3+\frac{b(I+ml^2)}{q}s^2-\frac{(M+m)mgl}{q}s-\frac{bmgl}{q}} \qquad [ \frac{rad}{N}]$$"></p>
      <p>where,</p>
      <p><span class="eqn_num">(2)</span><img class="display_eqn" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_eq24198.png" alt="$$q = (M+m)(I+ml^2) - (ml)^2$$"></p>
      <p>More specifically, the controller will attempt to maintain the pendulum vertically upward when the cart is subjected to a
         1-Nsec impulse. Under these conditions, the design criteria are:
      </p>
      <div>
         <ul>
            <li>Settling time of less than 5 seconds</li>
            <li>Pendulum should not move more than 0.05 radians away from the vertical</li>
         </ul>
      </div>
      <p>For the original problem setup and the derivation of the above transfer function, please consult the <a href="indexdeb1.html?example=InvertedPendulum&amp;section=SystemModeling">Inverted Pendulum: System Modeling</a> page.
      </p>
      <h2>System structure<a name="3"></a></h2>
      <p>The structure of the controller for this problem is a little different than the standard control problems you may be used
         to. Since we are attempting to control the pendulum's position, which should return to the vertical after the initial disturbance,
         the reference signal we are tracking should be zero. This type of situation is often referred to as a regulator problem. The
         external force applied to the cart can be considered as an impulsive disturbance. The schematic for this problem is depicted
         below.
      </p>
      <p><img class="figure"vspace="5" hspace="5" src="Content/InvertedPendulum/Control/PID/figures/feedback_pend.png" alt=""> </p>
      <p>You may find it easier to analyze and design for this system if we first rearrange the schematic as follows.</p>
      <p><img class="figure"vspace="5" hspace="5" src="Content/InvertedPendulum/Control/PID/figures/feedback_pend2.png" alt=""> </p>
      <p>The resulting transfer function <img class="inline_eqn" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_eq42924.png" alt="$T(s)$"> for the closed-loop system from an input of force <img class="inline_eqn" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_eq86924.png" alt="$F$"> to an output of pendulum angle <img class="inline_eqn" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_eq26509.png" alt="$\phi$"> is then determined to be the following.
      </p>
      <p><span class="eqn_num">(3)</span><img class="display_eqn" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_eq30884.png" alt="$$ T(s) = \frac{\Phi(s)}{F(s)} = \frac{P_{pend}(s)}{1 + C(s)} $$"></p>
      <p>Before we begin designing our PID controller, we first need to define our plant within MATLAB. Create a new <a href="indexd754.html?aux=Extras_Mfile">m-file</a> and type in the following commands to create the plant model (refer to the main problem for the details of getting these
         commands).
      </p><pre class="codeinput">M = 0.5;
m = 0.2;
b = 0.1;
I = 0.006;
g = 9.8;
l = 0.3;
q = (M+m)*(I+m*l^2)-(m*l)^2;
s = tf(<span class="string">'s'</span>);
P_pend = (m*l*s/q)/(s^3 + (b*(I + m*l^2))*s^2/q - ((M + m)*m*g*l)*s/q - b*m*g*l/q);
</pre><p>Next we will define a PID controller.</p>
      <h2>PID control<a name="8"></a></h2>
      <p>This closed-loop transfer function can be modeled in MATLAB by copying the following code to the end of your m-file (whether
         you're using the transfer function form or the state-space representation of the plant). Specifically, we define our controller
         using the <tt>pid</tt> object within MATLAB. We then use the <tt>feedback</tt> command to generate the closed-loop transfer function <img class="inline_eqn" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_eq42924.png" alt="$T(s)$"> as depicted in the figure above where the disturbance force <img class="inline_eqn" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_eq86924.png" alt="$F$"> is the input and the deviation of the pendulum angle from the vertical <img class="inline_eqn" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_eq26509.png" alt="$\phi$"> is the output.
      </p><pre class="codeinput">Kp = 1;
Ki = 1;
Kd = 1;
C = pid(Kp,Ki,Kd);
T = feedback(P_pend,C);
</pre><p>Now we can begin to tune our controller. First let's examine the response of the closed-loop system to an impulse disturbance
         for this initial set of control gains. Enter the following code to the end of your m-file and run in the MATLAB command window.
         You should generate the response plot shown below.
      </p><pre class="codeinput">t=0:0.01:10;
impulse(T,t)
title(<span class="string">'Response of Pendulum Position to an Impulse Disturbance under PID Control: Kp = 1, Ki = 1, Kd = 1'</span>);
</pre><img class="figure"vspace="5" hspace="5" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_01.png" alt=""> <p>This response is still not stable. Let's begin to modify the response by increasing the proportional gain. Increase the <img class="inline_eqn" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_eq63713.png" alt="$K_p$"> variable to see what effect it has on the response. If you modify your m-file to the following where <img class="inline_eqn" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_eq63713.png" alt="$K_p$"> = 100 and run in the command window, you should get the response plot shown below.
      </p><pre class="codeinput">Kp = 100;
Ki = 1;
Kd = 1;
C = pid(Kp,Ki,Kd);
T = feedback(P_pend,C);
t=0:0.01:10;
impulse(T,t)
axis([0, 2.5, -0.2, 0.2]);
title(<span class="string">'Response of Pendulum Position to an Impulse Disturbance under PID Control: Kp = 100, Ki = 1, Kd = 1'</span>);
</pre><img class="figure"vspace="5" hspace="5" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_02.png" alt=""> <p>Right-clicking on the resulting plot and choosing <b>Characteristics</b> from the resulting menu allows you to identify important characteristics of the response. Specifically, the settling time
         of the response is determined to be 1.64 seconds, which is less than the requirement of 5 seconds. Since the steady-state
         error approaches zero in a sufficiently fast manner, no additional integral action is needed. You can set the integral gain
         constant <img class="inline_eqn" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_eq10252.png" alt="$K_i$"> to zero to see for yourself that some integral control is needed. The peak response, however, is larger than the requirement
         of 0.05 radians. Recall that overshoot often can be reduced by increasing the amount of derivative control. After some trial
         and error it is found that a derivative gain of <img class="inline_eqn" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_eq58630.png" alt="$K_d$"> = 20 provides a satisfactory response. Modifying your m-file as follows and re-running should produce the response plot shown
         below
      </p><pre class="codeinput">Kp = 100;
Ki = 1;
Kd = 20;
C = pid(Kp,Ki,Kd);
T = feedback(P_pend,C);
t=0:0.01:10;
impulse(T,t)
axis([0, 2.5, -0.2, 0.2]);
title(<span class="string">'Response of Pendulum Position to an Impulse Disturbance under PID Control: Kp = 100, Ki = 1, Kd = 20'</span>);
</pre><img class="figure"vspace="5" hspace="5" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_03.png" alt=""> <p>As you can see, the overshoot has been reduced so that the pendulum does not move more than 0.05 radians away from the vertical.
         Since all of the given design requirements have been met, no further iteration is needed.
      </p>
      <h2>What happens to the cart's position?<a name="14"></a></h2>
      <p>At the beginning of this page, a block diagram for the inverted pendulum system was given. The diagram was not entirely complete.
         The block representing the response of the cart's position <img class="inline_eqn" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_eq43551.png" alt="$x$"> was not included because that variable is not being controlled. It is interesting though, to see what is happening to the
         cart's position when the controller for the pendulum's angle <img class="inline_eqn" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_eq26509.png" alt="$\phi$"> is in place. To see this we need to consider the full system block diagram as shown in the following figure.
      </p>
      <p><img class="figure"vspace="5" hspace="5" src="Content/InvertedPendulum/Control/PID/figures/feedback_pend3.png" alt=""> </p>
      <p>Rearranging, we get the following block diagram.</p>
      <p><img class="figure"vspace="5" hspace="5" src="Content/InvertedPendulum/Control/PID/figures/feedback_pend4.png" alt=""> </p>
      <p>In the above, the block <img class="inline_eqn" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_eq46098.png" alt="$C(s)$"> is the controller designed for maintaining the pendulum vertical. The closed-loop transfer function <img class="inline_eqn" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_eq08994.png" alt="$T_2(s)$"> from an input force applied to the cart to an output of cart position is, therefore, given by the following.
      </p>
      <p><span class="eqn_num">(4)</span><img class="display_eqn" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_eq20946.png" alt="$$ T_2(s) = \frac{X(s)}{F(s)} = \frac{P_{cart}(s)}{1 + P_{pend}(s)C(s)}$$"></p>
      <p>Referring to the <a href="indexdeb1.html?example=InvertedPendulum&amp;section=SystemModeling">Inverted Pendulum: System Modeling</a> page, the transfer function for <img class="inline_eqn" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_eq12765.png" alt="$\mathrm{P_{cart}}(s)$"> is defined as follows.
      </p>
      <p><span class="eqn_num">(5)</span><img class="display_eqn" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_eq29227.png" alt="$$P_{cart}(s) = \frac{X(s)}{U(s)} = \frac{ \frac{ (I+ml^2)s^2 - gml } {q}&#xA;}{s^4+\frac{b(I+ml^2)}{q}s^3-\frac{(M+m)mgl}{q}s^2-\frac{bmgl}{q}s}&#xA;\qquad [ \frac{m}{N}] $$"></p>
      <p>where,</p>
      <p><span class="eqn_num">(6)</span><img class="display_eqn" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_eq00187.png" alt="$$q=[(M+m)(I+ml^2)-(ml)^2]$$"></p>
      <p>Adding the following commands to your m-file (presuming <img class="inline_eqn" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_eq75257.png" alt="$\mathrm{P_{pend}}(s)$"> and <img class="inline_eqn" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_eq46098.png" alt="$C(s)$"> are still defined) will generate the response of the cart's position to the same impulsive disturbance we have been considering.
      </p><pre class="codeinput">P_cart = (((I+m*l^2)/q)*s^2 - (m*g*l/q))/(s^4 + (b*(I + m*l^2))*s^3/q - ((M + m)*m*g*l)*s^2/q - b*m*g*l*s/q);
T2 = feedback(1,P_pend*C)*P_cart;
t = 0:0.01:5;
impulse(T2, t);
title(<span class="string">'Response of Cart Position to an Impulse Disturbance under PID Control: Kp = 100, Ki = 1, Kd = 20'</span>);
</pre><img class="figure"vspace="5" hspace="5" src="Content/InvertedPendulum/Control/PID/html/InvertedPendulum_ControlPID_04.png" alt=""> <p>As you can see, the cart moves in the negative direction with approximately constant velocity. Therefore, although the PID
         controller stabilizes the angle of the pendulum, this design would not be feasible to implement on an actual physical system.
      </p>
      <p class="footer"><br>
         Published with MATLAB&reg; 7.14<br></p>
   </div>
</div>
<!--
##### SOURCE BEGIN #####
%% Inverted Pendulum: PID Controller Design
%
% Key MATLAB commands used in this tutorial are:
% <http://www.mathworks.com/help/toolbox/control/ref/ss.html |tf|> , 
% <http://www.mathworks.com/help/toolbox/control/ref/tf.html |impulse|> , 
% <http://www.mathworks.com/help/toolbox/control/ref/feedback.html |feedback|> , 
% <http://www.mathworks.com/help/toolbox/control/ref/pid.html |pid|> 
%
%%
% In this page we will design a PID controller for the inverted pendulum
% system. In the design process we will assume a single-input,
% single-output plant as described by the following transfer function.
% Otherwise stated, we will attempt to control the pendulum's angle without
% regard for the cart's position.
% 
% $$P_{pend}(s) = \frac{\Phi(s)}{U(s)}=\frac{\frac{ml}{q}s}{s^3+\frac{b(I+ml^2)}{q}s^2-\frac{(M+m)mgl}{q}s-\frac{bmgl}{q}} \qquad [ \frac{rad}{N}]$$
% 
% where,
% 
% $$q = (M+m)(I+ml^2) - (ml)^2$$
% 
% More specifically, the controller will attempt to maintain the pendulum
% vertically upward when the cart is subjected to a 1-Nsec impulse. Under
% these conditions, the design criteria are:
%
% * Settling time of less than 5 seconds
% * Pendulum should not move more than 0.05 radians away from the vertical
%
%%
% For the original problem setup and the derivation of the above transfer function,
% please consult the < ?example=InvertedPendulum&section=SystemModeling Inverted Pendulum: System Modeling> page. 
%% System structure
%
% The structure of the controller for this problem is a little different
% than the standard control problems you may be used to. Since we are
% attempting to control the pendulum's position, which should return to the
% vertical after the initial disturbance, the reference signal we are
% tracking should be zero. This type of situation is often referred to as a
% regulator problem. The external force applied to the cart can be considered as an
% impulsive disturbance. The schematic for this problem is depicted below.
%
% <<Content/InvertedPendulum/Control/PID/figures/feedback_pend.png>>
%
%%
% You may find it easier to analyze and design for this system if we first
% rearrange the schematic as follows.
%
% <<Content/InvertedPendulum/Control/PID/figures/feedback_pend2.png>>
%
%%
% The resulting transfer function $T(s)$ for the closed-loop system from an input of force
% $F$ to an output of pendulum angle $\phi$ is then determined to be the following.
%
% $$ T(s) = \frac{\Phi(s)}{F(s)} = \frac{P_{pend}(s)}{1 + C(s)} $$
%
%%
% Before we begin designing our PID controller, we first need to define our
% plant within MATLAB. Create a new
% < ?aux=Extras_Mfile m-file> and type in
% the following commands to create the plant model (refer to the main
% problem for the details of getting these commands). 

M = 0.5;
m = 0.2;
b = 0.1;
I = 0.006;
g = 9.8;
l = 0.3;
q = (M+m)*(I+m*l^2)-(m*l)^2;
s = tf('s');
P_pend = (m*l*s/q)/(s^3 + (b*(I + m*l^2))*s^2/q - ((M + m)*m*g*l)*s/q - b*m*g*l/q);

%%
% Next we will define a PID controller.

%% PID control
% This closed-loop transfer function can be modeled in MATLAB by copying
% the following code to the end of your m-file (whether you're using the
% transfer function form or the state-space representation of the plant).
% Specifically, we define our controller using the |pid| object within
% MATLAB. We then use the |feedback| command to generate the closed-loop
% transfer function $T(s)$ as depicted in the figure above where the
% disturbance force $F$ is the input and the deviation of the pendulum
% angle from the vertical $\phi$ is the output. 

Kp = 1;
Ki = 1;
Kd = 1;
C = pid(Kp,Ki,Kd);
T = feedback(P_pend,C);

%% 
% Now we can begin to tune our controller. First let's examine the response
% of the closed-loop system to an impulse disturbance for this
% initial set of control gains. Enter the following code to the end of your
% m-file and run in the MATLAB command window. You should generate the
% response plot shown below.
%
%%

t=0:0.01:10;
impulse(T,t)
title('Response of Pendulum Position to an Impulse Disturbance under PID Control: Kp = 1, Ki = 1, Kd = 1');

%%
% This response is still not stable. Let's begin to modify the response by
% increasing the proportional gain. Increase the $K_p$ variable to see what
% effect it has on the response. If you modify your m-file to the following
% where $K_p$ = 100 and run in the command window, you should get the
% response plot shown below.

Kp = 100;
Ki = 1;
Kd = 1;
C = pid(Kp,Ki,Kd);
T = feedback(P_pend,C);
t=0:0.01:10;
impulse(T,t)
axis([0, 2.5, -0.2, 0.2]);
title('Response of Pendulum Position to an Impulse Disturbance under PID Control: Kp = 100, Ki = 1, Kd = 1');

%%
% Right-clicking on the resulting plot and choosing *Characteristics* from
% the resulting menu allows you to identify important characteristics of
% the response. Specifically, the settling time of the response is
% determined to be 1.64 seconds, which is less than the requirement of 5
% seconds. Since the steady-state error approaches zero in a sufficiently
% fast manner, no additional integral action is needed. You can set the 
% integral gain constant $K_i$ to zero to see for yourself that some
% integral control is needed. The peak response, however, is larger than the
% requirement of 0.05 radians. Recall that overshoot often can be reduced
% by increasing the amount of derivative control. After some trial and
% error it is found that a derivative gain of $K_d$ = 20 provides a
% satisfactory response. Modifying your m-file as follows and re-running
% should produce the response plot shown below

Kp = 100;
Ki = 1;
Kd = 20;
C = pid(Kp,Ki,Kd);
T = feedback(P_pend,C);
t=0:0.01:10;
impulse(T,t)
axis([0, 2.5, -0.2, 0.2]);
title('Response of Pendulum Position to an Impulse Disturbance under PID Control: Kp = 100, Ki = 1, Kd = 20');

%% 
% As you can see, the overshoot has been reduced so that the pendulum does
% not move more than 0.05 radians away from the vertical. Since all of the
% given design requirements have been met, no further iteration is needed.
%
%% What happens to the cart's position?
% At the beginning of this page, a block diagram for the inverted pendulum
% system was given. The diagram was not entirely complete. The block 
% representing the response of the cart's position $x$ was not included
% because that variable is not being controlled. It is interesting though,
% to see what is happening to the cart's position when the controller for
% the pendulum's angle $\phi$ is in place. To see this we need to consider
% the full system block diagram as shown in the following figure.
% 
% <<Content/InvertedPendulum/Control/PID/figures/feedback_pend3.png>>
% 
% Rearranging, we get the following block diagram.
% 
% <<Content/InvertedPendulum/Control/PID/figures/feedback_pend4.png>>
% 
% In the above, the block $C(s)$ is the controller designed for maintaining
% the pendulum vertical. The closed-loop transfer function $T_2(s)$ from an input force applied
% to the cart to an output of cart position is, therefore, given by the
% following. 
%
% $$ T_2(s) = \frac{X(s)}{F(s)} = \frac{P_{cart}(s)}{1 + P_{pend}(s)C(s)}$$
%
%%
% Referring to the < ?example=InvertedPendulum&section=SystemModeling Inverted Pendulum: System Modeling>
% page, the transfer function for
% $\mathrm{P_{cart}}(s)$ is defined as follows. 
% 
% $$P_{cart}(s) = \frac{X(s)}{U(s)} = \frac{ \frac{ (I+ml^2)s^2 - gml } {q}
% }{s^4+\frac{b(I+ml^2)}{q}s^3-\frac{(M+m)mgl}{q}s^2-\frac{bmgl}{q}s}
% \qquad [ \frac{m}{N}] $$
%
% where,
%
% $$q=[(M+m)(I+ml^2)-(ml)^2]$$
%
%%
% Adding the following commands to your m-file (presuming $\mathrm{P_{pend}}(s)$ and
% $C(s)$ are still defined) will generate the response of the cart's
% position to the same impulsive disturbance we have been considering.

P_cart = (((I+m*l^2)/q)*s^2 - (m*g*l/q))/(s^4 + (b*(I + m*l^2))*s^3/q - ((M + m)*m*g*l)*s^2/q - b*m*g*l*s/q);
T2 = feedback(1,P_pend*C)*P_cart;
t = 0:0.01:5;
impulse(T2, t);
title('Response of Cart Position to an Impulse Disturbance under PID Control: Kp = 100, Ki = 1, Kd = 20');

%% 
% As you can see, the cart moves in the negative direction with
% approximately constant velocity. Therefore, although the PID controller
% stabilizes the angle of the pendulum, this design would not be feasible
% to implement on an actual physical system.   


##### SOURCE END #####
-->				</div>
				
				<div id="left">

					<ul class="section">
						<li class="heading" id="System">SYSTEM<img class="section_heading_arrow" src="Images/section_heading_arrow.png"/></li>
						<li class="item" id="SystemModeling"><a href="indexdeb1.html?example=InvertedPendulum&amp;section=SystemModeling">MODELING<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
						<li class="item" id="SystemAnalysis"><a href="indexce00.html?example=InvertedPendulum&amp;section=SystemAnalysis">ANALYSIS<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
					</ul>
					
					<div class="section_break"></div>

					<ul class="section">
						<li class="heading" id="Control">CONTROL<img class="section_heading_arrow" src="Images/section_heading_arrow.png"/></li>
						<li class="item" id="ControlPID"><a href="index9b2d.html?example=InvertedPendulum&amp;section=ControlPID">PID<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
						<li class="item" id="ControlRootLocus"><a href="index2ed1.html?example=InvertedPendulum&amp;section=ControlRootLocus">ROOT&nbsp;LOCUS<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
						<li class="item" id="ControlFrequency"><a href="index64c4.html?example=InvertedPendulum&amp;section=ControlFrequency">FREQUENCY<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
						<li class="item" id="ControlStateSpace"><a href="index96a8.html?example=InvertedPendulum&amp;section=ControlStateSpace">STATE-SPACE<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
						<li class="item" id="ControlDigital"><a href="index5759.html?example=InvertedPendulum&amp;section=ControlDigital">DIGITAL<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
					</ul>
					
					<div class="section_break"></div>

					<ul class="section">
						<li class="heading" id="Simulink">SIMULINK<img class="section_heading_arrow" src="Images/section_heading_arrow.png"/></li>
						<li class="item" id="SimulinkModeling"><a href="indexffaa.html?example=InvertedPendulum&amp;section=SimulinkModeling">MODELING<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
						<li class="item" id="SimulinkControl"><a href="indexd477.html?example=InvertedPendulum&amp;section=SimulinkControl">CONTROL<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
					</ul>
		
				</div>
			
				<div style="clear:both"></div>
				
				<div id="bottombar"><span style="color:#FF5500;font-weight:bold">.</div>
				
			</div>
			
		</div>
	
		<script type="text/javascript" src="script.js"></script>
						
	</body>
	

<!-- Mirrored from ctms.engin.umich.edu/CTMS/index.php?example=InvertedPendulum&section=ControlPID by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:11:46 GMT -->
</html>

	ControlPID by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:11:46 GMT -->
</html>

	
	
		<script type="text/javascript" src="script.js"></script>
						
	</body>
	

<!-- Mirrored from ctms.engin.umich.edu/CTMS/index.php?example=InvertedPendulum&section=ControlPID by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:11:46 GMT -->
</html>

	ControlPID by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:11:46 GMT -->
</html>

	pier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:11:46 GMT -->
</html>

	ControlPID by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:11:46 GMT -->
</html>

	