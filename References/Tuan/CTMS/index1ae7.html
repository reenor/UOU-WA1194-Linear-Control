<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

	
<!-- Mirrored from ctms.engin.umich.edu/CTMS/index.php?example=MotorPosition&section=ControlFrequency by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:10:43 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>

		<script type="text/javascript" src="jquery.js"></script>
					
		<link rel='stylesheet' type='text/css' href='style.css' />
		<script type="text/javascript">
	
			var example = "MotorPosition"; 
			var section = "ControlFrequency"; 
			var aux = ""; 
			var effects = Boolean(1); 
			var tips = Boolean(1); 
			$.fx.off = !effects;
			
			$(document).keydown(function(e){
				if (!$("#search_field").is(":focus")){
					if (e.keyCode == 39) { 
						window.location = "indexc79c.html?example=MotorPosition&amp;section=ControlStateSpace";
					}
					if (e.keyCode == 37) { 
						window.history.back()
					}
				}
			});		
			
		</script>
			
		<meta http-equiv="Content-Type" Content="text/html; charset=utf-8" />
		<meta http-equiv="PRAGMA" Content="NO-CACHE" />
		
		<title>Control Tutorials for MATLAB and Simulink - Motor Position: Frequency Domain Methods for Controller Design</title>
			
	</head>

	<body>
	
		
		<div id="container">
		
			<form id="search_form"><input id="search_field" type="text" name="q" placeholder="Search Control Tutorials"/></form>
			<form class="option_form" method="post" onclick="submit()"><div>Effects</div><input type="hidden" name="effects" value="0"/><input type="checkbox" name="effects" value="1" checked='true' /></form>
			<form class="option_form" method="post" onclick="submit()"><div>Tips</div><input type="hidden" name="tips" value="0"/><input type="checkbox" name="tips" value="1" checked='true' /></form>	
				
			<div style="clear:both"></div>
		
			<div id="header">
		
				

				
				
				<div id="menu_container">
				
					<ul class="menu">
						<li class="heading" id="Tips"><a href="index80e7.html?aux=Extras_Tips">TIPS</a></li>
						<div class="collapse"><div class="expand">
						</div></div>
					</ul>
				
					<ul class="menu">
						<li class="heading" id="About"><a>ABOUT</a></li>
						<div class="collapse"><div class="expand">
							<li class="item" id="About_Tutorials"><a href="index64fe.html?aux=About_Tutorials">Tutorials</a></li>
							<li class="item" id="About_Contact"><a href="mailto:ControlTutorialsMatlabSimulink@gmail.com">Contact</a></li>
						</div></div>
					</ul>
					
					<ul class="menu">
						<li class="heading" id="Basics"><a>BASICS</a></li>
						<div class="collapse"><div class="expand">
							<li class="item" id="Basics_Matlab"><a href="index87b6.html?aux=Basics_Matlab">MATLAB</a></li>
							<li class="item" id="Basics_Simulink"><a href="indexe9ea.html?aux=Basics_Simulink">Simulink</a></li>
						</div></div>
					</ul>
					
					<ul class="menu">
						<li class="heading" id="Index"><a>INDEX</a></li>
						<div class="collapse"><div class="expand">
							<li class="item" id="Index_Tutorials"><a href="index5e52.html?aux=Index_Tutorials">Tutorials</a></li>
							<li class="item" id="Index_Commands"><a href="index111e.html?aux=Index_Commands">Commands</a></li>
							<li class="item" id="Index_Animations"><a href="indexc3c5.html?aux=Index_Animations">Animations</a></li>
							<li class="item" id="Index_Extras"><a href="indexb290.html?aux=Index_Extras">Extras</a></li>
						</div></div>
					</ul>
									
					<ul class="menu">
						<li class="heading" id="Next"><a href="indexc79c.html?example=MotorPosition&amp;section=ControlStateSpace">NEXT&nbsp;&#x25BA;</a></li>
						<div class="collapse"><div class="expand">
						</div></div>
					</ul>
											
				</div>

			</div>
			
			<div id="body_container">
			
				<div id="gradient_container"></div>
			
				<div id="top">
				
					<a href="index1304.html?aux=Home"><img id="CTMS_logo" src="Images/CTMS_logo.png"></a>
				
					<ul class="example">
					
						<li class="item" id="Introduction"><a href="index7f35.html?example=Introduction&amp;section=ControlFrequency"><img class="icon" src="Images/Introduction_Icon.png"><div class="tab">INTRODUCTION</div></a></li>
						<li class="item" id="CruiseControl"><a href="index75ab.html?example=CruiseControl&amp;section=ControlFrequency"><img class="icon" src="Images/CruiseControl_Icon.png"><div class="tab">CRUISE&nbsp;CONTROL</div></a></li>
						<li class="item" id="MotorSpeed"><a href="index5e29.html?example=MotorSpeed&amp;section=ControlFrequency"><img class="icon" src="Images/MotorSpeed_Icon.png"><div class="tab">MOTOR&nbsp;SPEED</div></a></li>
						<li class="item" id="MotorPosition"><a href="index1ae7.html?example=MotorPosition&amp;section=ControlFrequency"><img class="icon" src="Images/MotorPosition_Icon.png"><div class="tab">MOTOR&nbsp;POSITION</div></a></li>
						<li class="item" id="Suspension"><a href="indexee33.html?example=Suspension&amp;section=ControlFrequency"><img class="icon" src="Images/Suspension_Icon.png"><div class="tab">SUSPENSION</div></a></li>
						<li class="item" id="InvertedPendulum"><a href="index64c4.html?example=InvertedPendulum&amp;section=ControlFrequency"><img class="icon" src="Images/InvertedPendulum_Icon.png"><div class="tab">INVERTED&nbsp;PENDULUM</div></a></li>
						<li class="item" id="AircraftPitch"><a href="indexe97f.html?example=AircraftPitch&amp;section=ControlFrequency"><img class="icon" src="Images/AircraftPitch_Icon.png"><div class="tab">AIRCRAFT&nbsp;PITCH</div></a></li>
						<li class="item" id="BallBeam"><a href="index28b6.html?example=BallBeam&amp;section=ControlFrequency"><img class="icon" src="Images/BallBeam_Icon.png"><div class="tab">BALL&nbsp;&amp;&nbsp;BEAM</div></a></li>
					
					</ul> 
		
				</div>
				
				<div id="content_container">
					<div class="content">
   <div class="content_fx">
      <h1>DC Motor Position: Frequency Domain Methods for Controller Design</h1>
      <!--introduction-->
      <p>Key MATLAB commands used in this tutorial are: <a href="http://www.mathworks.com/help/toolbox/control/ref/tf.html"><tt>tf</tt></a> , <a href="http://www.mathworks.com/help/toolbox/control/ref/sisotool.html"><tt>sisotool</tt></a></p>
      <!--/introduction-->
      <h2>Contents</h2>
      <div>
         <ul>
            <li><a href="#4">Drawing the uncompensated system's Bode plot</a></li>
            <li><a href="#7">Adding an integrator</a></li>
            <li><a href="#9">Gain and phase margin specifications and controller design</a></li>
         </ul>
      </div>
      <p>From the main problem, the open-loop transfer function of the DC Motor is given as follows.</p>
      <p><span class="eqn_num">(1)</span><img class="display_eqn" src="Content/MotorPosition/Control/Frequency/html/MotorPosition_ControlFrequency_eq78774.png" alt="$$ P(s) = \frac {\Theta (s)}{V(s)} = \frac{K}{s ( (Js + b)(Ls + R) + K^2 )} \qquad [ \frac{rad}{V}  ] $$"></p>
      <p>The structure of the control system has the form shown in the figure below.</p>
      <p><img class="figure"vspace="5" hspace="5" src="Content/MotorPosition/Control/Frequency/figures/feedback_motorp.png" alt=""> </p>
      <p>For the original problem setup and the derivation of the above equations, please refer to the <a href="index9ba6.html?example=MotorPosition&amp;section=SystemModeling">DC Motor Position: System Modeling</a> page.
      </p>
      <p>With a 1-radian step reference, the design criteria are the following.</p>
      <div>
         <ul>
            <li>Settling time less than 0.040 seconds</li>
            <li>Overshoot less than 16%</li>
            <li>No steady-state error, even in the presence of a step disturbance input</li>
         </ul>
      </div>
      <p>First create a new <a href="indexd754.html?aux=Extras_Mfile">m-file</a> and type in the following commands (refer to main problem for the details of getting these commands).
      </p><pre class="codeinput">J = 3.2284E-6;
b = 3.5077E-6;
K = 0.0274;
R = 4;
L = 2.75E-6;
s = tf(<span class="string">'s'</span>);
P_motor = K/(s*((J*s+b)*(L*s+R)+K^2));
</pre><h2>Drawing the uncompensated system's Bode plot<a name="4"></a></h2>
      <p>The main idea of frequency-based design is to use the Bode plot of the open-loop transfer function to estimate the system's
         closed-loop response. Adding a controller to the system changes the open-loop Bode plot, thereby changing the closed-loop
         response. Let's first draw the Bode plot for the original open-loop transfer function. Throughout this section, we will use
         the interactive <b>SISO Design Tool</b> to design our controller. This tool can be opened for the uncompensated plant by adding the command <tt>sisotool('bode',P_motor)</tt> to your m-file.
      </p>
      <p>Two windows will open initially with the <b>SISO Design for SISO Design Task</b> window having the form shown in the figure below. This figure shows the open-loop Bode plot of the transfer function passed
         via the <tt>sisotool</tt> function. This figure appears initially due to the addition of the string <tt>'bode'</tt> to the function call. If the string <tt>'bode'</tt> is omitted, the default initial window includes the root locus plot in addition to the open-loop Bode plot.
      </p>
      <p><img class="figure"vspace="5" hspace="5" src="Content/MotorPosition/Control/Frequency/figures/Picture1.png" alt=""> </p>
      <p>From previous pages we know that the open-loop plant in unity feedback does not satisfy the given system requirements. We
         will, therefore, add different compensators to our system in order to reshape the open-loop Bode plot to give the desired
         closed-loop performance.
      </p>
      <h2>Adding an integrator<a name="7"></a></h2>
      <p>Now let's add a pure integrator compensator to our system. The architecture of the feedback system can be modified within
         the <b>SISO Design Tool</b> GUI, but the default compensator <b>C</b> is placed in series with the plant <b>G</b> in the forward path of the block diagram. This corresponds to the architecture we are assuming, as shown in the schematic
         at the top of this page. Placing an integral compensator in this position will achieve the goal of zero steady-state error
         in the presence of a step disturbance input.
      </p>
      <p>The form of our controller is then modified under the <b>Compensator Editor</b> tab of the <b>Control and Estimation Tools Manager</b> window. Specifically, an integrator is added to our controller by right-clicking in the <b>Dynamics</b> section of the window and selecting <b>Add Pole/Zero &gt; Integrator</b> from the resulting menu. The figure below illustrates what the <b>Control and Estimation Tools Manager</b> window should look like.
      </p>
      <p><img class="figure"vspace="5" hspace="5" src="Content/MotorPosition/Control/Frequency/figures/Picture3a.png" alt=""> </p>
      <p>The Bode plot that is already open should then change as shown below to reflect the addition of the integrator.</p>
      <p><img class="figure"vspace="5" hspace="5" src="Content/MotorPosition/Control/Frequency/figures/Picture3.png" alt=""> </p>
      <h2>Gain and phase margin specifications and controller design<a name="9"></a></h2>
      <p>Recall that we additionally desire an overshoot of less than 16%. Overshoot of a step response correlates to a system's phase
         margin. We will apply the relationship that phase margin approximately equals 100 times the damping ratio (<i>zeta</i>) to estimate the desired phase margin of our system. We will additionally use our 0.040 second settling time requirement
         to estimate the desired bandwidth frequency (<i>Wbw</i>) of our closed-loop system. Add the following code to your m-file to estimate the desired phase margin and bandwidth. Note
         that these relationships are intended for a second-order canonical system, which we do not have, but the results will serve
         as a good starting point for our design.
      </p><pre class="codeinput">zeta = -log(.16) / sqrt( pi^2 + (log(.16))^2 );
PM = 100*zeta
Wbw = (4/(0.04*zeta))*sqrt((1 - 2*zeta^2) + sqrt(4*zeta^4 - 4*zeta^2+2))
</pre><pre class="codeoutput">PM =
   50.3868
Wbw =
  251.5743
</pre><p>The above results demonstrate that we desire to have at least 50 degrees of phase margin in an attempt to meet the overshoot
         requirement. Also, a closed-loop bandwidth of 250 rad/sec is desired to additionally achieve the settle time requirement.
         We will estimate the closed-loop bandwidth as the point on the open-loop Bode plot where the magnitude is between -6 and -7.5
         dB. From the Bode plot we see that we must add about 110 degrees of phase and 80 dB of gain at a frequency of 250 rad/sec
         in order to move the gain crossover frequency to 250 rad/sec and provide 50 degrees of phase margin. The magnitude plot will
         then also lie between -6 and -7.5 dB at a frequency greater than 250 rad/sec.
      </p>
      <p>From the Bode phase plot we can see that there is a pole near -60 as indicated by the blue <tt>x</tt> on the Bode plot near the frequency 60 rad/sec (as well as the change in the magnitude and phase plots). We will, therefore,
         begin to modify our compensator by adding a zero at <i>s</i> = -60 in order to flatten out the phase curve. A real zero can be added again by right-clicking in the <b>Dynamics</b> section of the <b>Compensator Editor</b> tab of the <b>Control and Estimation Tools Manager</b> window. The location of the zero can then be set by typing -60 into the <b>Location</b> cell of the <b>Edit Selected Dynamics</b> portion of the window and pressing <b>Enter</b>. Your compensator now has the form of a PI controller and the compensated open-loop Bode plot should have the modified form
         shown below where the red <tt>o</tt> shows the location of the new zero. To achieve the limits on the axes shown below, right-click on the Bode plot and select
         <b>Properties</b> from the resulting menu.
      </p>
      <p><img class="figure"vspace="5" hspace="5" src="Content/MotorPosition/Control/Frequency/figures/Picture5b.png" alt=""> </p>
      <p>From the Bode plot we can see that we need at least 50 additional degrees of phase if we move our crossover frequency to 250
         rad/sec. Let's then add a lead compensator to add exactly 50 degrees of phase at this frequency. The following equations provide
         the pole and zero locations of the lead compensator.
      </p><pre class="codeinput">a = (1 - sin(PM*pi/180))/(1 + sin(PM*pi/180));
T = 1/(Wbw*sqrt(a));
zero = -1/T
pole = -1/(a*T)
</pre><pre class="codeoutput">zero =
  -90.6050
pole =
 -698.5222
</pre><p>The pole and zero of the lead compensator can then be added to our system in the same manner that the integrator and real
         zero were added above. Alternatively, we can add a lead compensator by specifiying the desired maximum phase and frequency
         location within the <b>SISO Design Tool</b> GUI. This is accomplished also by right-clicking in the <b>Dynamics</b> section of the <b>Compensator Editor</b> tab of the <b>Control and Estimation Tools Manager</b> window. Selecting the lead compensator in the <b>Dynamics</b> section of the window then opens four cells in the <b>Edit Selected Dynamics</b> portion of the window. These four cells allow you to specify the lead portion of the compensator either in terms of the pole
         and zero locations, or in terms of the phase and frequency location. If we enter 50 into the <b>Max Delta Phase (deg)</b> cell and 250 into the <b>at Frequency</b> cell and hit <b>Enter</b>, we will get a pole and zero location that closely (though not exactly) matches those we calculated above. The modified Bode
         plot should then have a similar appearance to the one shown below.
      </p>
      <p><img class="figure"vspace="5" hspace="5" src="Content/MotorPosition/Control/Frequency/figures/Picture6b.png" alt=""> </p>
      <p>This new Bode plot now shows that the phase margin is about right at 250 rad/sec, but the gain is too small by about 55 dB
         if we wish for the gain crossover to occur at 250 rad/sec. Note that each pole and zero we have added to the compensator has
         the form
      </p>
      <p><span class="eqn_num">(2)</span><img class="display_eqn" src="Content/MotorPosition/Control/Frequency/html/MotorPosition_ControlFrequency_eq65025.png" alt="$$  \frac{1}{T\ }s + 1 $$"></p>
      <p>rather than (<i>s+z</i>) or (<i>s+p</i>). This default form has a DC gain of 1. Therefore, your magnitude plot will be shifted up or down compared to the figure
         shown above if the terms of your compensator have the form (<i>s+z</i>) and (<i>s+p</i>). Converting from decibels determines that a gain of 600 will shift the magnitude plot up approximately 55 dBs. This change
         in gain can be accomplished by typing 600 into the cell multiplying the compensator at the top of the <b>Edit Compensator</b> tab and pressing <b>Enter</b>. The resulting Bode plot is shown below. As indicated on the plot, the phase margin is 49.8 degrees and the gain crossover
         frequency is 236 rad/sec which are close to our goals of 50 degrees and 250 rad/sec.
      </p>
      <p><img class="figure"vspace="5" hspace="5" src="Content/MotorPosition/Control/Frequency/figures/Picture7a.png" alt=""> </p>
      <p>Let's now check the resulting step response of the closed-loop system. This plot can be generated under the <b>Analysis Plots</b> tab of the <b>Control and Estimation Tools Manager</b> window. Specifically, under this tab choose <b>Plot 1</b> to be a <tt>Step</tt> from the drop-down menu in the <b>Analysis Plots</b> section of the tab. Then check <b>Closed Loop r to y</b> for <b>Plot 1</b> in the <b>Contents of Plots</b> section of the window. See the figure below for an illustration of this process.
      </p>
      <p><img class="figure"vspace="5" hspace="5" src="Content/MotorPosition/Control/Frequency/figures/Picture7b.png" alt=""> </p>
      <p>The resulting step response plot is shown below, where the details of the peak response and the settling time are added from
         the right-click menu under <b>Characteristics</b>.
      </p>
      <p><img class="figure"vspace="5" hspace="5" src="Content/MotorPosition/Control/Frequency/figures/Picture7c.png" alt=""> </p>
      <p>From the above figure, it can be seen that the overshoot is too large and the settling time is better than expected. This
         is attributable to the fact that our system does not actually have the form of a canonical second-order system and because
         we did not exactly achieve a phase margin of 50 degrees and a bandwidth of 250 rad/sec.
      </p>
      <p>In order to reduce the overshoot, we will adjust the lead portion of our compensator to provide more phase margin. Specifically,
         within the <b>Compensator Editor</b> tab you can change the value of the <b>Max Delta Phase (deg)</b>. By increasing this value, you should see the bump in the phase plot increase and the overshoot in the step response plot
         decrease (as long as the box for <b>Real-Time Update</b> is checked). This change will of course also affect the gain crossover frequency. Therefore, we need to change the value
         of the compensator gain to shift the magnitude plot such that the gain crossover frequency is still near 250 rad/sec. This
         can be accomplished by manually typing in different values for the gain in the <b>Edit Compensator</b> tab as we have done previously. Another option is to use the Bode plot since plots in the <b>SISO Design for SISO Design Task</b> allow for graphical tuning. Specifically, if you place your cursor over the magnitude plot it will turn into a hand and you
         can "grab" the plot and move it up or down. The gain in the compensator will automatically change to reflect the movement
         of the plot. In the end a choice of 70 degrees of additional phase at 250 rad/sec and a gain of 315 give us a phase margin
         of 70 degrees and an overshoot less than 16% as shown below.
      </p>
      <p><img class="figure"vspace="5" hspace="5" src="Content/MotorPosition/Control/Frequency/figures/Picture8a.png" alt=""> </p>
      <p><img class="figure"vspace="5" hspace="5" src="Content/MotorPosition/Control/Frequency/figures/Picture9a.png" alt=""> </p>
      <p>From the above step response we see that even though the overshoot is fine, the settling time is too long. We can speed up
         the system response by trying a slightly higher bandwidth. This can again be accomplished from the <b>Edit Compensator</b> tab by increasing the frequency where the peak phase of the lead compensator is positioned. Through trial and error we choose
         an <b>at Frequency</b> of 350 rad/sec. We then use the graphical tuning technique to "grab" the magnitude plot of the Bode diagram to shift the
         crossover frequency to a location that provides approximately 70 degrees of phase margin. A gain of 670 seems to work well.
      </p>
      <p>Throughout the tuning, the Bode diagram and step response plot changed according to the changes being made to the compensator.
         Your final plots should be similar to the two shown below.
      </p>
      <p><img class="figure"vspace="5" hspace="5" src="Content/MotorPosition/Control/Frequency/figures/Picture10a.png" alt=""> </p>
      <p><img class="figure"vspace="5" hspace="5" src="Content/MotorPosition/Control/Frequency/figures/Picture11a.png" alt=""> </p>
      <p>Now we have the performance we desire. We have less than 16% overshoot and a settling time less than 40 milliseconds. Furthermore,
         the integral action of the compensator provides zero steady-state error to a step reference, even in the presence of a step
         disturbance input.
      </p>
      <p class="footer"><br>
         Published with MATLAB&reg; 7.14<br></p>
   </div>
</div>
<!--
##### SOURCE BEGIN #####
%% DC Motor Position: Frequency Domain Methods for Controller Design
%
% Key MATLAB commands used in this tutorial are:
% <http://www.mathworks.com/help/toolbox/control/ref/tf.html |tf|> , 
% <http://www.mathworks.com/help/toolbox/control/ref/sisotool.html |sisotool|> 
%
%% 
% From the main problem, the open-loop transfer function of the DC Motor is
% given as follows.
% 
% $$ P(s) = \frac {\Theta (s)}{V(s)} = \frac{K}{s ( (Js + b)(Ls + R) + K^2 )} \qquad [ \frac{rad}{V}  ] $$
%
% The structure of the control system has the form shown in the figure below. 
%
% <<Content/MotorPosition/Control/Frequency/figures/feedback_motorp.png>>
%
%%
% For the original problem setup and the derivation of the above equations,
% please refer to the
% < ?example=MotorPosition&section=SystemModeling
% DC Motor Position: System Modeling> page. 
%
% With a 1-radian step reference, the design criteria are the following.
%
% * Settling time less than 0.040 seconds
% * Overshoot less than 16%
% * No steady-state error, even in the presence of a step disturbance input
%%
% First create a new < ?aux=Extras_Mfile
% m-file> and type in the following commands (refer to main
% problem for the details of getting these commands). 

J = 3.2284E-6;
b = 3.5077E-6;
K = 0.0274;
R = 4;
L = 2.75E-6;
s = tf('s');
P_motor = K/(s*((J*s+b)*(L*s+R)+K^2));

%% Drawing the uncompensated system's Bode plot 
% The main idea of frequency-based design is to use the Bode plot of the
% open-loop transfer function to estimate the system's closed-loop response. Adding
% a controller to the system changes the open-loop Bode plot, thereby
% changing the closed-loop response. Let's first draw the Bode plot for
% the original open-loop transfer function. Throughout this section, we
% will use the interactive *SISO Design Tool* to design our controller. This tool
% can be opened for the uncompensated plant by adding the command
% |sisotool('bode',P_motor)| to your m-file.
%%
% Two windows will open initially with the *SISO Design for SISO Design
% Task* window having the form shown in the figure below. This figure shows
% the open-loop Bode plot of the transfer function passed via the
% |sisotool| function. This figure appears initially due to the
% addition of the string |'bode'| to the function call. If the string
% |'bode'| is omitted, the default initial window includes the root locus
% plot in addition to the open-loop Bode plot.
%
% <<Content/MotorPosition/Control/Frequency/figures/Picture1.png>>
%
%%
% From previous pages we know that the open-loop plant in unity feedback
% does not satisfy the given system requirements. We will, therefore,
% add different compensators to our system in order to reshape the
% open-loop Bode plot to give the desired closed-loop performance.
%
%% Adding an integrator
%
% Now let's add a pure integrator compensator to our system. The
% architecture of the feedback system can be modified within the *SISO Design Tool*
% GUI, but the default compensator *C* is placed in series with the plant
% *G* in the forward path of the block diagram. This corresponds to the
% architecture we are assuming, as shown in the schematic at the top
% of this page. Placing an integral compensator in this position will achieve the
% goal of zero steady-state error in the presence of a step disturbance input.
% 
% The form of our controller is then modified under the *Compensator
% Editor* tab of the *Control and Estimation Tools Manager* window.
% Specifically, an integrator is added to our controller by
% right-clicking in the *Dynamics* section of the window and selecting *Add
% Pole/Zero > Integrator* from the resulting menu. The figure below
% illustrates what the *Control and Estimation Tools Manager* window should
% look like.  
%
% <<Content/MotorPosition/Control/Frequency/figures/Picture3a.png>>
%
%%
% The Bode plot that is already open should then change as shown below to
% reflect the addition of the integrator.
%
% <<Content/MotorPosition/Control/Frequency/figures/Picture3.png>>
%
%% Gain and phase margin specifications and controller design
%
% Recall that we additionally desire an overshoot of less than 16%.
% Overshoot of a step response correlates to a system's phase margin. We
% will apply the relationship that phase margin approximately equals 100
% times the damping ratio (_zeta_) to estimate the desired phase margin of
% our system. We will additionally use our 0.040 second settling time
% requirement to estimate the desired bandwidth frequency (_Wbw_) of our
% closed-loop system. Add the following code to your m-file to estimate
% the desired phase margin and bandwidth. Note that these relationships are
% intended for a second-order canonical system, which we do not have, but
% the results will serve as a good starting point for our design.

zeta = -log(.16) / sqrt( pi^2 + (log(.16))^2 );
PM = 100*zeta
Wbw = (4/(0.04*zeta))*sqrt((1 - 2*zeta^2) + sqrt(4*zeta^4 - 4*zeta^2+2))

%%
% The above results demonstrate that we desire to have at least 50 degrees
% of phase margin in an attempt to meet the overshoot requirement.
% Also, a closed-loop bandwidth of 250 rad/sec is desired to additionally
% achieve the settle time requirement. We will estimate the closed-loop
% bandwidth as the point on the open-loop Bode plot where the magnitude is
% between -6 and -7.5 dB. From the Bode plot we see that we must add about
% 110 degrees of phase and 80 dB of gain at a frequency of 250 rad/sec in
% order to move the gain crossover frequency to 250 rad/sec and provide 50
% degrees of phase margin. The magnitude plot will then also lie between -6
% and -7.5 dB at a frequency greater than 250 rad/sec. 
%
% From the Bode phase plot we can see that there is a pole near -60
% as indicated by the blue |x| on the Bode plot near the frequency 60
% rad/sec (as well as the change in the magnitude and phase plots). We will,
% therefore, begin to modify our compensator by adding a zero at 
% _s_ = -60 in order to flatten out the phase curve. A real zero can be added
% again by right-clicking in the *Dynamics* section of the *Compensator
% Editor* tab of the *Control and Estimation Tools Manager* window. The
% location of the zero can then be set by typing -60 into the *Location*
% cell of the *Edit Selected Dynamics* portion of the window and pressing
% *Enter*. Your compensator now has the form of a PI controller and the
% compensated open-loop Bode plot should have the modified form shown
% below where the red |o| shows the location of the new zero. To achieve
% the limits on the axes shown below, right-click on the Bode plot and
% select *Properties* from the resulting menu.
%
% <<Content/MotorPosition/Control/Frequency/figures/Picture5b.png>>
%
%%
% From the Bode plot we can see that we need at least 50 additional degrees
% of phase if we move our crossover frequency to 250 rad/sec. Let's then
% add a lead compensator to add exactly 50 degrees of phase at this
% frequency. The following equations provide the pole and zero
% locations of the lead compensator.

a = (1 - sin(PM*pi/180))/(1 + sin(PM*pi/180));
T = 1/(Wbw*sqrt(a));
zero = -1/T
pole = -1/(a*T)

%%
% The pole and zero of the lead compensator can then be added to our system
% in the same manner that the integrator and real zero were added above.
% Alternatively, we can add a lead compensator by specifiying the desired
% maximum phase and frequency location within the *SISO Design Tool* GUI.
% This is accomplished also by right-clicking in the *Dynamics* section of the
% *Compensator Editor* tab of the *Control and Estimation Tools Manager*
% window. Selecting the lead compensator in the *Dynamics* section of the
% window then opens four cells in the *Edit Selected Dynamics* portion of
% the window. These four cells allow you to specify the lead portion of the
% compensator either in terms of the pole and zero locations, or in terms of
% the phase and frequency location. If we enter 50 into the *Max Delta
% Phase (deg)* cell and 250 into the *at Frequency* cell and hit *Enter*,
% we will get a pole and zero location that closely (though not exactly)
% matches those we calculated above. The modified Bode plot should then
% have a similar appearance to the one shown below.
%
% <<Content/MotorPosition/Control/Frequency/figures/Picture6b.png>>
%
%%
% This new Bode plot now shows that the phase margin is about right at 250
% rad/sec, but the gain is too small by about 55 dB if we wish for the gain
% crossover to occur at 250 rad/sec. Note that each pole and zero we have
% added to the compensator has the form
%
% $$  \frac{1}{T\ }s + 1 $$
%
% rather than (_s+z_) or (_s+p_). This default form has a DC gain of 1.
% Therefore, your magnitude plot will be shifted up or down compared to the
% figure shown above if the terms of your compensator have the form (_s+z_)
% and (_s+p_). Converting from decibels determines that a gain of
% 600 will shift the magnitude plot up approximately 55 dBs.
% This change in gain can be accomplished by typing 600 into the cell
% multiplying the compensator at the top of the *Edit Compensator* tab and
% pressing *Enter*. The resulting Bode plot is shown below. As indicated on
% the plot, the phase margin is 49.8 degrees and the gain crossover frequency
% is 236 rad/sec which are close to our goals of 50 degrees and 250 rad/sec. 
%
% <<Content/MotorPosition/Control/Frequency/figures/Picture7a.png>>
%
%%
% Let's now check the resulting step response of the closed-loop system.
% This plot can be generated under the *Analysis Plots* tab of the *Control and
% Estimation Tools Manager* window. Specifically, under this tab choose
% *Plot 1* to be a |Step| from the drop-down menu in the *Analysis Plots*
% section of the tab. Then check *Closed Loop r to y* for *Plot 1* in the
% *Contents of Plots* section of the window. See the figure below for an
% illustration of this process.
%
% <<Content/MotorPosition/Control/Frequency/figures/Picture7b.png>>
%
%%
% The resulting step response plot is shown below, where the details of the
% peak response and the settling time are added from the right-click menu
% under *Characteristics*.
%
% <<Content/MotorPosition/Control/Frequency/figures/Picture7c.png>>
%  
%%
% From the above figure, it can be seen that the overshoot is too large and
% the settling time is better than expected. This is attributable to the
% fact that our system does not actually have the form of a canonical
% second-order system and because we did not exactly achieve a phase margin
% of 50 degrees and a bandwidth of 250 rad/sec.
%
% In order to reduce the overshoot, we will adjust the lead portion of our
% compensator to provide more phase margin. Specifically, within the
% *Compensator Editor* tab you can change the value of the *Max Delta Phase
% (deg)*. By increasing this value, you should see the bump in the phase
% plot increase and the overshoot in the step response plot decrease (as
% long as the box for *Real-Time Update* is checked). This change will of
% course also affect the gain crossover frequency. Therefore, we need to
% change the value of the compensator gain to shift the magnitude plot such
% that the gain crossover frequency is still near 250 rad/sec. This can be
% accomplished by manually typing in different values for the gain in the
% *Edit Compensator* tab as we have done previously. Another option is to
% use the Bode plot since plots in the *SISO Design for SISO Design Task*
% allow for graphical tuning. Specifically, if you place your cursor over
% the magnitude plot it will turn into a hand and you can "grab" the plot
% and move it up or down. The gain in the compensator will automatically
% change to reflect the movement of the plot. In the end a choice of 70
% degrees of additional phase at 250 rad/sec and a gain of 315 give us a
% phase margin of 70 degrees and an overshoot less than 16% as shown below.
%
% <<Content/MotorPosition/Control/Frequency/figures/Picture8a.png>>
%
% <<Content/MotorPosition/Control/Frequency/figures/Picture9a.png>>
%
%%
% From the above step response we see that even though the overshoot is
% fine, the settling time is too long. We can speed up the system response
% by trying a slightly higher bandwidth. This can again be accomplished
% from the *Edit Compensator* tab by increasing the frequency where the
% peak phase of the lead compensator is positioned. Through trial and error
% we choose an *at Frequency* of 350 rad/sec. We then use the graphical
% tuning technique to "grab" the magnitude plot of the Bode diagram to
% shift the crossover frequency to a location that provides approximately
% 70 degrees of phase margin. A gain of 670 seems to work well.
%
% Throughout the tuning, the Bode diagram and step response plot changed
% according to the changes being made to the compensator. Your final plots
% should be similar to the two shown below. 
%
% <<Content/MotorPosition/Control/Frequency/figures/Picture10a.png>>
%
% <<Content/MotorPosition/Control/Frequency/figures/Picture11a.png>>
%
%%
% Now we have the performance we desire. We have less than 16% overshoot
% and a settling time less than 40 milliseconds. Furthermore, the integral
% action of the compensator provides zero steady-state error to a step
% reference, even in the presence of a step disturbance input.


##### SOURCE END #####
-->				</div>
				
				<div id="left">

					<ul class="section">
						<li class="heading" id="System">SYSTEM<img class="section_heading_arrow" src="Images/section_heading_arrow.png"/></li>
						<li class="item" id="SystemModeling"><a href="index9ba6.html?example=MotorPosition&amp;section=SystemModeling">MODELING<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
						<li class="item" id="SystemAnalysis"><a href="indexb7ed.html?example=MotorPosition&amp;section=SystemAnalysis">ANALYSIS<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
					</ul>
					
					<div class="section_break"></div>

					<ul class="section">
						<li class="heading" id="Control">CONTROL<img class="section_heading_arrow" src="Images/section_heading_arrow.png"/></li>
						<li class="item" id="ControlPID"><a href="indexe534.html?example=MotorPosition&amp;section=ControlPID">PID<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
						<li class="item" id="ControlRootLocus"><a href="index3c83.html?example=MotorPosition&amp;section=ControlRootLocus">ROOT&nbsp;LOCUS<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
						<li class="item" id="ControlFrequency"><a href="index1ae7.html?example=MotorPosition&amp;section=ControlFrequency">FREQUENCY<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
						<li class="item" id="ControlStateSpace"><a href="indexc79c.html?example=MotorPosition&amp;section=ControlStateSpace">STATE-SPACE<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
						<li class="item" id="ControlDigital"><a href="index7d62.html?example=MotorPosition&amp;section=ControlDigital">DIGITAL<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
					</ul>
					
					<div class="section_break"></div>

					<ul class="section">
						<li class="heading" id="Simulink">SIMULINK<img class="section_heading_arrow" src="Images/section_heading_arrow.png"/></li>
						<li class="item" id="SimulinkModeling"><a href="index6d09.html?example=MotorPosition&amp;section=SimulinkModeling">MODELING<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
						<li class="item" id="SimulinkControl"><a href="index4c9e.html?example=MotorPosition&amp;section=SimulinkControl">CONTROL<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
					</ul>
		
				</div>
			
				<div style="clear:both"></div>
				
				<div id="bottombar"><span style="color:#FF5500;font-weight:bold">.</div>
				
			</div>
			
		</div>
	
		<script type="text/javascript" src="script.js"></script>
						
	</body>
	

<!-- Mirrored from ctms.engin.umich.edu/CTMS/index.php?example=MotorPosition&section=ControlFrequency by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:10:55 GMT -->
</html>

	lFrequency by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:10:55 GMT -->
</html>

	
		<script type="text/javascript" src="script.js"></script>
						
	</body>
	

<!-- Mirrored from ctms.engin.umich.edu/CTMS/index.php?example=MotorPosition&section=ControlFrequency by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:10:55 GMT -->
</html>

	lFrequency by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:10:55 GMT -->
</html>

	pier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:10:55 GMT -->
</html>

	lFrequency by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:10:55 GMT -->
</html>

	