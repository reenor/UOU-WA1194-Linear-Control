<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

	
<!-- Mirrored from ctms.engin.umich.edu/CTMS/index.php?example=BallBeam&section=ControlDigital by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:05:42 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>

		<script type="text/javascript" src="jquery.js"></script>
					
		<link rel='stylesheet' type='text/css' href='style.css' />
		<script type="text/javascript">
	
			var example = "BallBeam"; 
			var section = "ControlDigital"; 
			var aux = ""; 
			var effects = Boolean(1); 
			var tips = Boolean(1); 
			$.fx.off = !effects;
			
			$(document).keydown(function(e){
				if (!$("#search_field").is(":focus")){
					if (e.keyCode == 39) { 
						window.location = "indexc9d4.html?example=BallBeam&amp;section=SimulinkModeling";
					}
					if (e.keyCode == 37) { 
						window.history.back()
					}
				}
			});		
			
		</script>
			
		<meta http-equiv="Content-Type" Content="text/html; charset=utf-8" />
		<meta http-equiv="PRAGMA" Content="NO-CACHE" />
		
		<title>Control Tutorials for MATLAB and Simulink - Ball & Beam: Digital Controller Design</title>
			
	</head>

	<body>
	
		
		<div id="container">
		
			<form id="search_form"><input id="search_field" type="text" name="q" placeholder="Search Control Tutorials"/></form>
			<form class="option_form" method="post" onclick="submit()"><div>Effects</div><input type="hidden" name="effects" value="0"/><input type="checkbox" name="effects" value="1" checked='true' /></form>
			<form class="option_form" method="post" onclick="submit()"><div>Tips</div><input type="hidden" name="tips" value="0"/><input type="checkbox" name="tips" value="1" checked='true' /></form>	
				
			<div style="clear:both"></div>
		
			<div id="header">
		
				

				
				
				<div id="menu_container">
				
					<ul class="menu">
						<li class="heading" id="Tips"><a href="index80e7.html?aux=Extras_Tips">TIPS</a></li>
						<div class="collapse"><div class="expand">
						</div></div>
					</ul>
				
					<ul class="menu">
						<li class="heading" id="About"><a>ABOUT</a></li>
						<div class="collapse"><div class="expand">
							<li class="item" id="About_Tutorials"><a href="index64fe.html?aux=About_Tutorials">Tutorials</a></li>
							<li class="item" id="About_Contact"><a href="mailto:ControlTutorialsMatlabSimulink@gmail.com">Contact</a></li>
						</div></div>
					</ul>
					
					<ul class="menu">
						<li class="heading" id="Basics"><a>BASICS</a></li>
						<div class="collapse"><div class="expand">
							<li class="item" id="Basics_Matlab"><a href="index87b6.html?aux=Basics_Matlab">MATLAB</a></li>
							<li class="item" id="Basics_Simulink"><a href="indexe9ea.html?aux=Basics_Simulink">Simulink</a></li>
						</div></div>
					</ul>
					
					<ul class="menu">
						<li class="heading" id="Index"><a>INDEX</a></li>
						<div class="collapse"><div class="expand">
							<li class="item" id="Index_Tutorials"><a href="index5e52.html?aux=Index_Tutorials">Tutorials</a></li>
							<li class="item" id="Index_Commands"><a href="index111e.html?aux=Index_Commands">Commands</a></li>
							<li class="item" id="Index_Animations"><a href="indexc3c5.html?aux=Index_Animations">Animations</a></li>
							<li class="item" id="Index_Extras"><a href="indexb290.html?aux=Index_Extras">Extras</a></li>
						</div></div>
					</ul>
									
					<ul class="menu">
						<li class="heading" id="Next"><a href="indexc9d4.html?example=BallBeam&amp;section=SimulinkModeling">NEXT&nbsp;&#x25BA;</a></li>
						<div class="collapse"><div class="expand">
						</div></div>
					</ul>
											
				</div>

			</div>
			
			<div id="body_container">
			
				<div id="gradient_container"></div>
			
				<div id="top">
				
					<a href="index1304.html?aux=Home"><img id="CTMS_logo" src="Images/CTMS_logo.png"></a>
				
					<ul class="example">
					
						<li class="item" id="Introduction"><a href="index4e79.html?example=Introduction&amp;section=ControlDigital"><img class="icon" src="Images/Introduction_Icon.png"><div class="tab">INTRODUCTION</div></a></li>
						<li class="item" id="CruiseControl"><a href="index6e12.html?example=CruiseControl&amp;section=ControlDigital"><img class="icon" src="Images/CruiseControl_Icon.png"><div class="tab">CRUISE&nbsp;CONTROL</div></a></li>
						<li class="item" id="MotorSpeed"><a href="indexf267.html?example=MotorSpeed&amp;section=ControlDigital"><img class="icon" src="Images/MotorSpeed_Icon.png"><div class="tab">MOTOR&nbsp;SPEED</div></a></li>
						<li class="item" id="MotorPosition"><a href="index7d62.html?example=MotorPosition&amp;section=ControlDigital"><img class="icon" src="Images/MotorPosition_Icon.png"><div class="tab">MOTOR&nbsp;POSITION</div></a></li>
						<li class="item" id="Suspension"><a href="index3cf8.html?example=Suspension&amp;section=ControlDigital"><img class="icon" src="Images/Suspension_Icon.png"><div class="tab">SUSPENSION</div></a></li>
						<li class="item" id="InvertedPendulum"><a href="index5759.html?example=InvertedPendulum&amp;section=ControlDigital"><img class="icon" src="Images/InvertedPendulum_Icon.png"><div class="tab">INVERTED&nbsp;PENDULUM</div></a></li>
						<li class="item" id="AircraftPitch"><a href="index3b26.html?example=AircraftPitch&amp;section=ControlDigital"><img class="icon" src="Images/AircraftPitch_Icon.png"><div class="tab">AIRCRAFT&nbsp;PITCH</div></a></li>
						<li class="item" id="BallBeam"><a href="index447e.html?example=BallBeam&amp;section=ControlDigital"><img class="icon" src="Images/BallBeam_Icon.png"><div class="tab">BALL&nbsp;&amp;&nbsp;BEAM</div></a></li>
					
					</ul> 
		
				</div>
				
				<div id="content_container">
					<div class="content">
   <div class="content_fx">
      <h1>Ball &amp; Beam: Digital PID Controller Design</h1>
      <!--introduction-->
      <p>Key MATLAB commands used in this tutorial are: <a href="http://www.mathworks.com/help/toolbox/control/ref/tf.html"><tt>tf</tt></a> , <a href="http://www.mathworks.com/help/toolbox/control/ref/c2d.html"><tt>c2d</tt></a> , <a href="http://www.mathworks.com/help/toolbox/control/ref/step.html"><tt>step</tt></a> , <a href="http://www.mathworks.com/help/techdoc/ref/stairs.html"><tt>stairs</tt></a> , <a href="http://www.mathworks.com/help/toolbox/control/ref/feedback.html"><tt>feedback</tt></a></p>
      <!--/introduction-->
      <h2>Contents</h2>
      <div>
         <ul>
            <li><a href="#2">Digital PID controller</a></li>
            <li><a href="#3">Discrete Transfer Function</a></li>
            <li><a href="#5">Open-loop response</a></li>
            <li><a href="#8">Proportional control</a></li>
            <li><a href="#11">Proportional-derivative control</a></li>
         </ul>
      </div>
      <p>The open-loop transfer function of the plant for the ball and beam experiment is given below:</p>
      <p><span class="eqn_num">(1)</span><img class="display_eqn" src="Content/BallBeam/Control/Digital/html/BallBeam_ControlDigital_eq90503.png" alt="$$&#xA;P(s) = \frac{R(s)}{\Theta(s)} =&#xA;-\frac{mgd}{L\left(\frac{J}{R^2}+m\right)}\frac{1}{s^2} \qquad [&#xA;\frac{m}{rad} ]&#xA;$$"></p>
      <p>The design criteria for this problem are:</p>
      <div>
         <ul>
            <li>Settling time less than 3 seconds</li>
            <li>Overshoot less than 5%</li>
         </ul>
      </div>
      <p>To see the derivation of the equations for this problem refer to the <a href="index9ee5.html?example=BallBeam&amp;section=SystemModeling">Ball &amp; Beam: System Modeling</a> page.
      </p>
      <h2>Digital PID controller<a name="2"></a></h2>
      <p>If you refer to any of the PID control problem for continuous systems, the PID transfer function was expressed as</p>
      <p><span class="eqn_num">(2)</span><img class="display_eqn" src="Content/BallBeam/Control/Digital/html/BallBeam_ControlDigital_eq40391.png" alt="$$&#xA;C(s) = K_p + \frac{K_i}{s} + K_d s = \frac{K_d s^2 + K_p s + K_i}{s}&#xA;$$"></p>
      <p>As you noticed the above transfer function was written in terms of s. For the digital PID control, we use the following transfer
         function in terms of z.
      </p>
      <p><span class="eqn_num">(3)</span><img class="display_eqn" src="Content/BallBeam/Control/Digital/html/BallBeam_ControlDigital_eq24117.png" alt="$$&#xA;C(z) = K_p + K_i\frac{z}{z-1}+K_d\frac{z-1}{z} = \frac{(K_p+K_i+K_d)z^2-(K_p+2K_d)z+K_d}{z^2-z}&#xA;$$"></p>
      <h2>Discrete Transfer Function<a name="3"></a></h2>
      <p>The first thing to do here is to convert the above continuous system transfer function to an equivalent discrete transfer
         function. To do this, we will use the MATLAB function <tt>c2d</tt>. To use <tt>c2d</tt>, we need to specify three arguments: system, sampling time (<tt>Ts</tt>), and the <tt>'method'</tt>. You should already be familiar with how to create a system from numerator and denominator matrices. The sampling time should
         be smaller than 1/(30*BW) sec, where BW is the closed-loop bandwidth frequency. The method we will use is the zero-order hold
         (<tt>'zoh'</tt>). Assuming that the closed-loop bandwidth frequency is around 1 rad/sec, let the sampling time be 1/50 sec/sample. Now we
         are ready to use <tt>c2d</tt>. Enter the following commands to an m-file. Running this m-file in the MATLAB command window gives you the following matrices.
      </p><pre class="codeinput">m = 0.111;
R = 0.015;
g = -9.8;
L = 1.0;
d = 0.03;
J = 9.99e-6;
s = tf(<span class="string">'s'</span>);
P_ball = -m*g*d/L/(J/R^2+m)/s^2;

Ts = 1/50;
ball_d = c2d(P_ball,Ts,<span class="string">'zoh'</span>)
</pre><pre class="codeoutput">
ball_d =
 
  4.2e-05 z + 4.2e-05
  -------------------
     z^2 - 2 z + 1
 
Sample time: 0.02 seconds
Discrete-time transfer function.

</pre><h2>Open-loop response<a name="5"></a></h2>
      <p>Now we will observe the ball's response to a step input of 0.25 m. To do this, enter the following commands into a new m-file
         and run it in the command window. You should see the following response.
      </p><pre class="codeinput">numDz = 0.0001*[0.42 0.42];
denDz = [1 -2 1];
Ts = 1/50;
ball_d = tf(numDz,denDz,Ts);

[x,t] = step(0.25*ball_d,5);
stairs(t,x)
</pre><img class="figure"vspace="5" hspace="5" src="Content/BallBeam/Control/Digital/html/BallBeam_ControlDigital_01.png" alt=""> <p>From this plot, it is clear that the open-loop system is unstable causing the ball to roll off the end of the beam.</p>
      <h2>Proportional control<a name="8"></a></h2>
      <p>Now we will add proportional control (Kp) to the system and obtain the closed-loop system response. For now let Kp equal 100
         and see what happens to the response. Enter the following commands into a new m-file and run it in the command window.
      </p><pre class="codeinput">Ts = 1/50;
z = tf(<span class="string">'z'</span>,Ts);
dP_ball = 0.0001*(0.42*z + 0.42)/(z^2 - 2*z + 1);

Kp=100;
sys_cl = feedback(Kp*dP_ball,1);

[x,t] = step(0.25*sys_cl,5);
stairs(t,x)
</pre><img class="figure"vspace="5" hspace="5" src="Content/BallBeam/Control/Digital/html/BallBeam_ControlDigital_02.png" alt=""> <p>As you can see, the addition of proportional control does not make the system stable. You may try to increase the proportional
         gain (Kp) and confirm that the system remains unstable.
      </p>
      <h2>Proportional-derivative control<a name="11"></a></h2>
      <p>Now we will add a derivative term to the controller. Keep the proportional gain (Kp) equal to 100, and let the derivative
         gain (Kd) equal to 10. Copy the following code to an new m-file and run it to view the system response.
      </p><pre class="codeinput">Ts = 1/50;
z = tf(<span class="string">'z'</span>,Ts);
dP_ball = 0.0001*(0.42*z + 0.42)/(z^2 - 2*z + 1);

Kp=100;
Kd=10;

C = ((Kp+Kd)*z^2 - (Kp+2*Kd)*z + Kd)/(z^2 + z);

sys_cl = feedback(C*dP_ball,1);

[x,t] = step(0.25*sys_cl,5);
stairs(t,x)
</pre><img class="figure"vspace="5" hspace="5" src="Content/BallBeam/Control/Digital/html/BallBeam_ControlDigital_03.png" alt=""> <p>Now the system is stable, but the rise time is too long. From the PID Tutorial page, we see that the increasing the proportional
         gain (Kp) will decrease the rise time. Let's increase the proportional gain (Kp) to 1000 and see what happens. Change Kp in
         the above m-file from 100 to 1000 and rerun it in the command window. You should see the following step response.
      </p><pre class="codeinput">Kp=1000;
Kd=10;

C = ((Kp+Kd)*z^2 - (Kp+2*Kd)*z + Kd)/(z^2 + z);

sys_cl = feedback(C*dP_ball,1);

[x,t] = step(0.25*sys_cl,5);
stairs(t,x)
</pre><img class="figure"vspace="5" hspace="5" src="Content/BallBeam/Control/Digital/html/BallBeam_ControlDigital_04.png" alt=""> <p>As you can see, all of the design requirements are satisfied. For this particular problem, no implementation of an integral
         control was needed. But remember there is more than one solution for a control problem. For practice, you may try different
         P, I and D combinations to obtain a satisfactory response.
      </p>
      <p class="footer"><br>
         Published with MATLAB&reg; 7.14<br></p>
   </div>
</div>
<!--
##### SOURCE BEGIN #####
%% Ball & Beam: Digital PID Controller Design
%
% Key MATLAB commands used in this tutorial are:
% <http://www.mathworks.com/help/toolbox/control/ref/tf.html |tf|> ,
% <http://www.mathworks.com/help/toolbox/control/ref/c2d.html |c2d|> ,
% <http://www.mathworks.com/help/toolbox/control/ref/step.html |step|> ,
% <http://www.mathworks.com/help/techdoc/ref/stairs.html |stairs|> ,
% <http://www.mathworks.com/help/toolbox/control/ref/feedback.html |feedback|>
%
%% 
% 
% The open-loop transfer function of the plant for the ball and beam
% experiment is given below:
%
% $$ 
% P(s) = \frac{R(s)}{\Theta(s)} =
% -\frac{mgd}{L\left(\frac{J}{R^2}+m\right)}\frac{1}{s^2} \qquad [
% \frac{m}{rad} ]
% $$
%
% The design criteria for this problem are:
%
% * Settling time less than 3 seconds
% * Overshoot less than 5% 
%
% To see the derivation of the equations for this problem refer to the 
% < ?example=BallBeam&section=SystemModeling Ball & Beam: System Modeling> page.
%
%% Digital PID controller
%
% If you refer to any of the PID control problem for continuous systems,
% the PID transfer function was expressed as 
%
% $$
% C(s) = K_p + \frac{K_i}{s} + K_d s = \frac{K_d s^2 + K_p s + K_i}{s}
% $$
%
% As you noticed the above transfer function was written in terms of s. For
% the digital PID control, we use the following transfer function in terms of z. 
%
% $$
% C(z) = K_p + K_i\frac{z}{z-1}+K_d\frac{z-1}{z} = \frac{(K_p+K_i+K_d)z^2-(K_p+2K_d)z+K_d}{z^2-z}
% $$
%
%% Discrete Transfer Function
%
% The first thing to do here is to convert the above continuous system
% transfer function to an equivalent discrete transfer function. To do this, 
% we will use the MATLAB function |c2d|. To use |c2d|, we need to specify three 
% arguments: system, sampling time (|Ts|), and the |'method'|. You should already
% be familiar with how to create a system from numerator and denominator matrices. 
% The sampling time should be smaller than 1/(30*BW) sec, where BW is the 
% closed-loop bandwidth frequency. The method we will use is the zero-order 
% hold (|'zoh'|). Assuming that the closed-loop bandwidth frequency is around 
% 1 rad/sec, let the sampling time be 1/50 sec/sample. Now we are ready to 
% use |c2d|. Enter the following commands to an m-file. Running this m-file 
% in the MATLAB command window gives you the following matrices.  
%
%%

m = 0.111;
R = 0.015;
g = -9.8;
L = 1.0;
d = 0.03;
J = 9.99e-6;
s = tf('s');
P_ball = -m*g*d/L/(J/R^2+m)/s^2;

Ts = 1/50;
ball_d = c2d(P_ball,Ts,'zoh')

%% Open-loop response
%
% Now we will observe the ball's response to a step input of 0.25 m. To do
% this, enter the following commands into a new m-file and run it in the 
% command window. You should see the following response. 
%
%%

numDz = 0.0001*[0.42 0.42];
denDz = [1 -2 1];
Ts = 1/50;
ball_d = tf(numDz,denDz,Ts);

[x,t] = step(0.25*ball_d,5);
stairs(t,x)

%%
%
% From this plot, it is clear that the open-loop system is unstable causing
% the ball to roll off the end of the beam. 
%
%% Proportional control
%
% Now we will add proportional control (Kp) to the system and obtain the
% closed-loop system response. For now let Kp equal 100 and see what happens 
% to the response. Enter the following commands into a new m-file and run 
% it in the command window. 
%
%%

Ts = 1/50;
z = tf('z',Ts);
dP_ball = 0.0001*(0.42*z + 0.42)/(z^2 - 2*z + 1);

Kp=100;
sys_cl = feedback(Kp*dP_ball,1);

[x,t] = step(0.25*sys_cl,5);
stairs(t,x)

%%
%
% As you can see, the addition of proportional control does not make the
% system stable. You may try to increase the proportional gain (Kp) and 
% confirm that the system remains unstable. 
%
%% Proportional-derivative control
%
% Now we will add a derivative term to the controller. Keep the
% proportional gain (Kp) equal to 100, and let the derivative gain (Kd) 
% equal to 10. Copy the following code to an new m-file and run it to view 
% the system response. 
%
%% 

Ts = 1/50;
z = tf('z',Ts);
dP_ball = 0.0001*(0.42*z + 0.42)/(z^2 - 2*z + 1);

Kp=100;
Kd=10;

C = ((Kp+Kd)*z^2 - (Kp+2*Kd)*z + Kd)/(z^2 + z);

sys_cl = feedback(C*dP_ball,1);

[x,t] = step(0.25*sys_cl,5);
stairs(t,x)

%%
%
% Now the system is stable, but the rise time is too long. From the PID
% Tutorial page, we see that the increasing the proportional gain (Kp) will 
% decrease the rise time. Let's increase the proportional gain (Kp) to 1000 
% and see what happens. Change Kp in the above m-file from 100 to 1000 and 
% rerun it in the command window. You should see the following step response. 
%
%% 

Kp=1000;
Kd=10;

C = ((Kp+Kd)*z^2 - (Kp+2*Kd)*z + Kd)/(z^2 + z);

sys_cl = feedback(C*dP_ball,1);

[x,t] = step(0.25*sys_cl,5);
stairs(t,x)

%%
%
% As you can see, all of the design requirements are satisfied. For this
% particular problem, no implementation of an integral control was needed. 
% But remember there is more than one solution for a control problem. For 
% practice, you may try different P, I and D combinations to obtain a 
% satisfactory response.
##### SOURCE END #####
-->				</div>
				
				<div id="left">

					<ul class="section">
						<li class="heading" id="System">SYSTEM<img class="section_heading_arrow" src="Images/section_heading_arrow.png"/></li>
						<li class="item" id="SystemModeling"><a href="index9ee5.html?example=BallBeam&amp;section=SystemModeling">MODELING<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
						<li class="item" id="SystemAnalysis"><a href="index136b.html?example=BallBeam&amp;section=SystemAnalysis">ANALYSIS<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
					</ul>
					
					<div class="section_break"></div>

					<ul class="section">
						<li class="heading" id="Control">CONTROL<img class="section_heading_arrow" src="Images/section_heading_arrow.png"/></li>
						<li class="item" id="ControlPID"><a href="index543f.html?example=BallBeam&amp;section=ControlPID">PID<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
						<li class="item" id="ControlRootLocus"><a href="indexc9b8.html?example=BallBeam&amp;section=ControlRootLocus">ROOT&nbsp;LOCUS<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
						<li class="item" id="ControlFrequency"><a href="index28b6.html?example=BallBeam&amp;section=ControlFrequency">FREQUENCY<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
						<li class="item" id="ControlStateSpace"><a href="indexfa3e.html?example=BallBeam&amp;section=ControlStateSpace">STATE-SPACE<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
						<li class="item" id="ControlDigital"><a href="index447e.html?example=BallBeam&amp;section=ControlDigital">DIGITAL<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
					</ul>
					
					<div class="section_break"></div>

					<ul class="section">
						<li class="heading" id="Simulink">SIMULINK<img class="section_heading_arrow" src="Images/section_heading_arrow.png"/></li>
						<li class="item" id="SimulinkModeling"><a href="indexc9d4.html?example=BallBeam&amp;section=SimulinkModeling">MODELING<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
						<li class="item" id="SimulinkControl"><a href="index7413.html?example=BallBeam&amp;section=SimulinkControl">CONTROL<img class="section_arrow" src="Images/section_arrow.png"/></a></li>
					</ul>
		
				</div>
			
				<div style="clear:both"></div>
				
				<div id="bottombar"><span style="color:#FF5500;font-weight:bold">.</div>
				
			</div>
			
		</div>
	
		<script type="text/javascript" src="script.js"></script>
						
	</body>
	

<!-- Mirrored from ctms.engin.umich.edu/CTMS/index.php?example=BallBeam&section=ControlDigital by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:05:43 GMT -->
</html>

	rolDigital by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:05:43 GMT -->
</html>

	iv>
	
		<script type="text/javascript" src="script.js"></script>
						
	</body>
	

<!-- Mirrored from ctms.engin.umich.edu/CTMS/index.php?example=BallBeam&section=ControlDigital by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:05:43 GMT -->
</html>

	rolDigital by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:05:43 GMT -->
</html>

	pier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:05:43 GMT -->
</html>

	rolDigital by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 19 Jun 2014 21:05:43 GMT -->
</html>

	